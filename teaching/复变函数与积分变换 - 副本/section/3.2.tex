\section{柯西-古萨定理和复合闭路定理}

\subsection{柯西-古萨定理}

\begin{frame}{积分路径无关与闭路积分}
	\onslide<+->
	观察下方的两条曲线 $C_1,C_2$.
	\onslide<+->
	设 $C=C_1^-+C_2$.
	\onslide<+->
	可以看出
	\[\int_{C_1}f(z)\diff z=\int_{C_2}f(z)\diff z\iff
	\oint_Cf(z)\diff z=\int_{C_2}f(z)\diff z-\int_{C_1}f(z)\diff z=0.\]
	\onslide<+->
	所以 $f(z)$ 的积分只与起点终点有关 $\iff f(z)$ 绕任意闭路的积分为零.
	\onslide<+->
	这里, 如果 $C$ 不是闭路(有自相交的点), 也可以拆分为一些闭路的并.

	\onslide<1->
	\begin{center}
		\begin{tikzpicture}
			\coordinate (O);
			\coordinate (A) at (2,2);
			\coordinate (C) at ({2+2*cos(145)},{2*sin(145)});
			\coordinate (D) at ({2*cos(-45)},{2+2*sin(-45)});
			\draw (O) node[below left,second] {$z_0$};
			\draw (A) node[above right,second] {$z$};
			\draw (C) node[above left,main] {$C_1$};
			\draw (D) node[below right,third] {$C_2$};
			\begin{scope}[cstcurve]
				\draw[third] (A) arc(0:-90:2);
				\draw[third,cstwra] ({2*cos(-50)},{2+2*sin(-50)}) arc(-50:-45:2);
				\draw[main] (O) arc(180:90:2);
				\draw[main,cstwra] ({2+2*cos(140)},{2*sin(140)}) arc(140:135:2);
				\draw[second,cstwla,visible on=<2->] ({1+0.3*cos(135)},{1+0.3*sin(135)}) arc(135:-110:0.3);
			\end{scope}
		\end{tikzpicture}
	\end{center}
\end{frame}


\begin{frame}{积分路径无关的函数特点}
	\onslide<+->
	上一节中我们计算了 $f(z)=z,\Re z,\dfrac1{z-z_0}$ 的积分.
	\onslide<+->
	其中
	\begin{itemize}
		\item $f(z)=z$ 处处解析, 积分只与起点终点有关 (闭路积分为零);
		\item $f(z)=\dfrac1{z-z_0}$ 有奇点 $z_0$, 沿绕 $z_0$ 闭路的积分非零;
		\item $f(z)=\Re z$ 处处不解析, 积分与路径有关 (闭路积分可能非零).
	\end{itemize}
	\onslide<+->
	由此可见函数沿闭路积分为零,
	\onslide<+->
	与函数在闭路内部是否解析有关.
\end{frame}


\begin{frame}{柯西-古萨定理: 推导}
	\onslide<+->
	设 $C$ 是一条闭路, $D$ 是其内部区域.
	\onslide<+->
	设 \emph{$f(z)$ 在闭区域 $\ov D=D\cup C$ 上解析},
	\onslide<+->
	即存在区域 $B\supseteq\ov D$ 使得 $f(z)$ 在 $B$ 上解析.

	\onslide<+->
	为了简便假设 $f'(z)$ 连续,
	\onslide<+->
	则
	\[\oint_Cf(z)\diff z=\oint_C(u\diff x-v\diff y)
	+i\oint_C(v\diff x+u\diff y).\]
	\onslide<+->
	由格林公式和C-R方程可知
	\[\oint_Cf(z)\diff z=-\iint_D(v_x+u_y)\diff x\diff y
	+i\iint_D(u_x-v_y)\diff x\diff y=0.\]
	\onslide<+->
	也可以从
	\[\oint_Cf(z)\diff z=-\iint_D\frac{\partial f}{\partial \ov z}\diff z\diff \ov z=2i\iint_D\frac{\partial f}{\partial \ov z}\diff x\diff y=0\]
	看出.
\end{frame}


\begin{frame}{柯西-古萨定理}
	\onslide<+->
	\begin{algorithm}{柯西-古萨定理}
	设 $f(z)$ 在闭路 $C$ 上连续, $C$ 内部解析, 则 $\displaystyle\oint_Cf(z)\diff z=0$.
	\end{algorithm}

	\onslide<+->
	\begin{corollary}
	设 $f(z)$ 在\alert{单连通区域} $D$ 内解析, $C$ 是 $D$ 内一条闭合曲线, 则 $\displaystyle\oint_Cf(z)\diff z=0$.
	\end{corollary}
	\onslide<+->
	这里的闭合曲线可以不是闭路.

	% \onslide<+->
	% 这是因为即使不是简单曲线也可以拆分为一些简单曲线.
	% \onslide<4->
	% \begin{center}
	% 	\begin{tikzpicture}
	% 		\draw[cstcurve,main,smooth,domain=-45:-15] plot({3*sqrt(cos(2*\x))*cos(\x)},{3*sqrt(cos(2*\x))*sin(\x)});
	% 		\draw[cstcurve,main,smooth,domain=-20:45,cstwla] plot({3*sqrt(cos(2*\x))*cos(\x)},{3*sqrt(cos(2*\x))*sin(\x)});
	% 		\draw[cstcurve,main,smooth,domain=-45:-15] plot({-2*sqrt(cos(2*\x))*cos(\x)},{2*sqrt(cos(2*\x))*sin(\x)});
	% 		\draw[cstcurve,main,smooth,domain=-20:45,cstwla] plot({-2*sqrt(cos(2*\x))*cos(\x)},{2*sqrt(cos(2*\x))*sin(\x)});
	% 		\draw[cstcurve,second,cstwla,ultra thick] (1.05,0.35) arc (135:-135:0.5);
	% 		\draw[cstcurve,third,cstwla,ultra thick] (-0.75,-0.25) arc (315:45:0.3535);
	% 	\end{tikzpicture}
	% \end{center}
\end{frame}


\begin{frame}{典型例题: 柯西-古萨定理计算积分}
	\onslide<+->
	\begin{example}
		求 $\displaystyle\oint_{|z|=1}\frac1{2z-3}\diff z$.
	\end{example}

	\onslide<+->
	\begin{solution}
		由于 $\dfrac1{2z-3}$ 在 $|z|\le 1$ 上解析,
		\onslide<+->{因此由柯西-古萨定理 $\displaystyle \oint_{|z|=1}\frac1{2z-3}\diff z=0$.}
	\end{solution}

	\onslide<+->
	\begin{exercise}
		\begin{enumerate}
			\item $\displaystyle\oint_{|z-2|=1}\frac1{z^2+z}\diff z=$\fillblankframe{$0$}.
			\item 求 $\displaystyle\oint_{|z|=2}\dfrac{\sin z}{|z|}\diff z=$\fillblankframe{$0$}.
		\end{enumerate}
	\end{exercise}
\end{frame}


\begin{frame}{例: 柯西-古萨定理计算积分}
	\onslide<+->
	\begin{example}
		求 $\displaystyle\oint_C\frac1{z(z^2+1)}\diff z$, 其中 $C:|z-i|=\dfrac12$.
	\end{example}

	\onslide<+->
	\begin{solution}
		注意到 $\dfrac1{z(z^2+1)}=\dfrac1z-\dfrac12\left(\dfrac1{z+i}+\dfrac1{z-i}\right)$.
		\onslide<+->{由于 $\dfrac1z,\dfrac1{z+i}$ 在 $|z-i|\le\dfrac12$ 上解析,
		}\onslide<+->{因此由柯西-古萨定理
			\[\oint_C\frac1z\diff z
			=\oint_C\frac1{z+i}\diff z=0,\]
		}\onslide<+->{
			\[\oint_C\frac1{z(z^2+1)}\diff z
			=-\half\oint_C\frac1{z-i}\diff z=-\pi i.\]}
	\end{solution}
\end{frame}


\subsection{复合闭路定理}

\begin{frame}{多连通区域边界与复合闭路}
	\onslide<+->
	设 $C_0,C_1,\dots,C_n$ 是 $n+1$ 条简单闭曲线, $C_1,\dots,C_n$ 每一条都包含在其它闭路的外部, 而且它们都包含在 $C_0$ 的内部.
	\onslide<+->
	这样它们围成了一个多连通区域 $D$, 它的边界称为一个\emph{复合闭路} \[C=C_0+C_1^-+\cdots+C_n^-.\]
	\onslide<+->
	沿着 $C$ 前进的点, $D$ 总在它的左侧,所以这就是它的正方向.
	\onslide<1->
	\begin{center}
		\begin{tikzpicture}
			\fill[cstfill,visible on=<2->,rounded corners=15mm] (-2.5,-1.5) rectangle (2.5,1.5);
			\draw[cstcurve,main,rounded corners=15mm] (-2.5,-1.5) rectangle (2.5,1.5);
			\fill[cstcurve,white,visible on=<2->] (1,0) circle(0.6);
			\fill[cstcurve,white,visible on=<2->] (-1,0) circle(0.6);
			\draw[cstcurve,main] (1,0) circle(0.6);
			\draw[cstcurve,main] (-1,0) circle(0.6);
			\draw[cstcurve,main,domain=85:90,cstwra,visible on=<2->] plot (.3,1.5)--(0,1.5);
			\draw[cstcurve,main,domain=135:140,cstwla,visible on=<2->] plot ({1+0.6*cos(\x)}, {0.6*sin(\x)});
			\draw[cstcurve,main,domain=135:140,cstwla,visible on=<2->] plot ({-1+0.6*cos(\x)}, {0.6*sin(\x)});
			\draw
				(2.2,1.3) node[main] {$C_0$}
				(-1,0.85) node[main] {$C_1^{\visible<2->-}$}
				(1,0.85) node[main] {$C_2^{\visible<2->-}$};
		\end{tikzpicture}
	\end{center}
\end{frame}


\begin{frame}{复合闭路定理}
	\onslide<+->
	\begin{algorithm}{复合闭路定理}
		设 $f(z)$ 在复合闭路 $C=C_0+C_1^-+\cdots+C_n^-$ 及其所围成的多连通区域内解析, 则
		\[\oint_{C_0}f(z)\diff z=
		\oint_{C_1}f(z)\diff z+\cdots+\oint_{C_n}f(z)\diff z.\]
	\end{algorithm}
	\onslide<+->
	事实上, 复合闭路定理和柯西-古萨定理可以看成一个定理的两种情形: 
	\onslide<+->
	设 $C$ 是一个闭路或复合闭路, 若 $f(z)$ 在 $C$ 及其围成的区域(单连通或多连通)内解析, 则 $\displaystyle\oint_Cf(z)\diff z=0$.
\end{frame}



\begin{frame}{复合闭路定理: 注记}
	\onslide<+->
	在实际应用中, 如果被积函数 $f(z)$ 在(复合)闭路 $C$ 的内部有有限多个奇点 $z_1,\dots,z_k$.
	\onslide<+->
	那么我们可以在 $C$ 内部(围成的区域)构造闭路 $C_1,\dots,C_k$, 使得每个 $C_j$ 内部只包含一个奇点 $z_j$.
	\onslide<+->
	这样, 内部含多个奇点的情形就可以化成内部只含一个奇点的情形. 最后将这些闭路上的积分相加即可.
	\onslide<1->
	\begin{center}
		\begin{tikzpicture}
			\draw[cstcurve,main,rounded corners=10mm] (-2.2,-1.2) rectangle (2.2,1.2);
			\draw[cstcurve,second,visible on=<2->] (1,0) circle(0.4);
			\draw[cstcurve,second,visible on=<2->] (0,0) circle(0.4);
			\draw[cstcurve,second,visible on=<2->] (-1,0) circle(0.4);
			\fill[cstdot,second] (1,0) circle;
			\fill[cstdot,second] (0,0) circle;
			\fill[cstdot,second] (-1,0) circle;
			\draw
				(-1,-0.25) node[second] {$z_1$}
				(0,-0.25) node[second] {$z_2$}
				(1,-0.25) node[second] {$z_3$}
				(2.2,1.1) node[main] {$C$}
				(-1,0.65) node[second,visible on=<2->] {$C_1$}
				(0,0.65) node[second,visible on=<2->] {$C_2$}
				(1,0.65) node[second,visible on=<2->] {$C_3$};
		\end{tikzpicture}
	\end{center}
\end{frame}


\begin{frame}{复合闭路定理: 注记}
	\onslide<+->
	此外, 从复合闭路定理还可以看出, 在计算积分 $\displaystyle \oint_C f(z)\diff z$ 时, $C$ 的具体形状无关紧要, 只要其内部奇点不变, $C$ 可以任意变形.
	\onslide<+->
	因为我们总可以选择一个包含这些奇点的闭路 $C'$, 使得 $C'$ 包含在 $C$ 及其变形后的闭路内部. 这样它们的积分自然都和 $C'$ 上的积分相同.
	\onslide<+->
	这里即使 $C$ 是复合闭路也是可以自由变形的.
	\onslide<1->
	\begin{center}
		\begin{tikzpicture}
			\draw[cstcurve,main,rounded corners=10mm] (-2.2,-1.2) rectangle (2.2,1.2);
			\draw[cstcurve,third] (0,0) circle(1.2 and 2.2);
			\draw[cstcurve,second,visible on=<2->] (0,0) circle(1);
			\fill[cstdot,second] (.7,0.2) circle;
			\fill[cstdot,second] (0,-0.4) circle;
			\fill[cstdot,second] (-.5,0.1) circle;
			\draw
				(2,1.4) node[main] {$C_1$}
				(-1.1,1.8) node[third] {$C_2$}
				(-.4,0.65) node[second,visible on=<2->] {$C'$};
		\end{tikzpicture}
	\end{center}
\end{frame}


\begin{frame}{复合闭路定理}
	\onslide<+->
	\begin{proof}
		以曲线 $\gamma_1,\gamma_2,\dots,\gamma_{n+1}$ 把 $C_0,C_1,\dots,C_n$ 连接起来, 则它们把区域 $D$ 分成了两个单连通区域 $D_1,D_2$.
		\onslide<+->{对 $D_1$ 和 $D_2$ 的边界应用柯西-古萨定理并相加, 则 $\gamma_i$ 对应的部分正好相互抵消,
		}\onslide<+->{因此
			\[\oint_{C_0}f(z)\diff z-
		\oint_{C_1}f(z)\diff z-\cdots-\oint_{C_n}f(z)\diff z=0.\]
		}\onslide<+->{于是定理得证.\qedhere}
		\vspace{-1.7\baselineskip}
		\onslide<1->
		\begin{center}
			\begin{tikzpicture}[scale=.9]
				\fill[cstcurve,cstfill] (0,0) circle(2.5 and 1.5);
				\fill[cstcurve,white] (1,0) circle(0.6);
				\fill[cstcurve,white] (-1,0) circle(0.6);

				\draw[cstcurve,main,domain=0:90,cstwra] plot ({2.5*cos(\x)}, {1.5*sin(\x)});
				\draw[cstcurve,main,domain=85:180] plot ({2.5*cos(\x)}, {1.5*sin(\x)});
				\draw[cstcurve,second,domain=180:270,cstwra] plot ({2.5*cos(\x)}, {1.5*sin(\x)});
				\draw[cstcurve,second,domain=265:360] plot ({2.5*cos(\x)}, {1.5*sin(\x)});

				\draw[cstcurve,main,domain=0:140] plot ({1+0.6*cos(\x)}, {0.6*sin(\x)});
				\draw[cstcurve,main,domain=135:180,cstwla] plot ({1+0.6*cos(\x)}, {0.6*sin(\x)});
				\draw[cstcurve,second,domain=180:320] plot ({1+0.6*cos(\x)}, {0.6*sin(\x)});
				\draw[cstcurve,second,domain=315:360,cstwla] plot ({1+0.6*cos(\x)}, {0.6*sin(\x)});

				\draw[cstcurve,main,domain=0:140] plot ({-1+0.6*cos(\x)}, {0.6*sin(\x)});
				\draw[cstcurve,main,domain=135:180,cstwla] plot ({-1+0.6*cos(\x)}, {0.6*sin(\x)});
				\draw[cstcurve,second,domain=180:320] plot ({-1+0.6*cos(\x)}, {0.6*sin(\x)});
				\draw[cstcurve,second,domain=315:360,cstwla] plot ({-1+0.6*cos(\x)}, {0.6*sin(\x)});

				\draw
					(2,1.3) node[main] {$C_0$}
					(-1,0.85) node[main] {$C_1^-$}
					(1,0.85) node[main] {$C_2^-$}
					(-2,-0.3) node {$\gamma_1$}
					(0,-0.3) node {$\gamma_2$}
					(2,-0.3) node {$\gamma_3$};
				\draw[cstcurve] (-2.5,0)--(-1.6,0);
				\draw[cstcurve] (-0.4,0)--(0.4,0);
				\draw[cstcurve] (1.6,0)--(2.5,0);
				\draw[cstcurve,thick,main,visible on=<2->] (-2.5,0.025)--(-1.6,0.025);
				\draw[cstcurve,thick,second,visible on=<2->] (-2.5,-0.025)--(-1.6,-0.025);
				\draw[cstcurve,thick,main,visible on=<2->] (-0.4,0.025)--(0.4,0.025);
				\draw[cstcurve,thick,second,visible on=<2->] (-0.4,-0.025)--(0.4,-0.025);
				\draw[cstcurve,thick,main,visible on=<2->] (1.6,0.025)--(2.5,0.025);
				\draw[cstcurve,thick,second,visible on=<2->] (1.6,-0.025)--(2.5,-0.025);
			\end{tikzpicture}
		\end{center}
		\vspace{-\baselineskip}
	\end{proof}
\end{frame}


\begin{frame}{例: 复合闭路定理的应用}
	\onslide<+->
	\begin{example}
		证明对于任意闭路 $C$, $\displaystyle\int_C(z-a)^n\diff z=0$, $n\neq -1$ 为整数.
	\end{example}

	\onslide<+->
	\begin{proof}
		\begin{enumerate}
			\item 如果 $a$ 不在 $C$ 的内部, 则 $(z-a)^n$ 在 $C$ 及其内部解析.
			\onslide<+->{%
				由柯西-古萨定理, $\displaystyle\int_C(z-a)^n\diff z=0$.
			}
			\item 如果 $a$ 在 $C$ 的内部, 则在 $C$ 的内部取一个以 $a$ 为圆心的圆周 $C_1$.
			\onslide<+->{%
				由复合闭路定理以及上一节的结论
				\[
					\int_C(z-a)^n\diff z=\int_{C_1}(z-a)^n\diff z=0.\qedhere
				\]
			}
			\vspace{-\baselineskip}
		\end{enumerate}
	\end{proof}
\end{frame}


\begin{frame}{例: 复合闭路定理的应用}
	\onslide<+->
	同理, 由复合闭路定理和上一节的结论可知当 $a$ 在 $C$ 的内部且 $n=-1$ 时积分为 $2\pi i$.
	\onslide<+->
	\begin{theorem@}
		当 $a$ 在 $C$ 的内部时,
		\[\oint_C\frac{\diff z}{(z-a)^{n+1}}=\begin{cases}2\pi i,&n=0;\\0,&n\neq 0.\end{cases}\]
	\end{theorem@}
\end{frame}


\begin{frame}{例: 复合闭路定理的应用}
	\beqskip{4pt}
	\onslide<+->
	\begin{example}
		\begin{minipage}{.6\textwidth}
			求 $\displaystyle\int_\Gamma\frac{2z-1}{z^2-z}\diff z$, 其中 $\Gamma$ 是由 $2\pm i,-2\pm i$ 形成的矩形闭路.
		\end{minipage}
		\begin{minipage}{.36\textwidth}
			\begin{tikzpicture}
				\draw[cstaxis] (-2.5,0)--(2.5,0);
				\draw[cstaxis] (0,-1)--(0,1);
				\draw[cstcurve,cstwra,main] (-1,-0.7)--(-0.5,-0.7);
				\draw[cstcurve,cstwra,second,visible on=<3->] (-0.4,0) arc(180:225:0.4);
				\draw[cstcurve,cstwra,second,visible on=<3->] (0.6,0) arc(180:225:0.4);
				\draw[cstcurve,second,visible on=<3->] (0,0) circle (0.4);
				\draw[cstcurve,second,visible on=<3->] (1,0) circle (0.4);
				\fill[cstdot,third,visible on=<2->] (1,0) circle;
				\fill[cstdot,third,visible on=<2->] (0,0) circle;
				\draw[cstcurve,main] (-2,-0.7) rectangle (2,0.7);
				\draw
					(-0.6,0.4) node[second,visible on=<3->] {$C_1$}
					(1.6,0.4) node[second,visible on=<3->] {$C_2$}
					(-1,-0.5) node[main] {$\Gamma$};
			\end{tikzpicture}
		\end{minipage}
	\end{example}
	\onslide<+->
	\begin{solution}
		函数 $\dfrac{2z-1}{z^2-z}$ 在 $\Gamma$ 内有两个奇点 $z=0,1$.
		\onslide<+->{%
			设 $C_1,C_2$ 如图所示,
		}\onslide<+->{%
			由复合闭路定理
			\begin{align*}
				&\oint_\Gamma\frac{2z-1}{z^2-z}\diff z
				=\oint_{C_1}\frac{2z-1}{z^2-z}\diff z+\oint_{C_2}\frac{2z-1}{z^2-z}\diff z\\
				\visible<+->{=}&\visible<.->{\oint_{C_1}\frac1z\diff z+\oint_{C_1}\frac1{z-1}\diff z
				+\oint_{C_2}\frac1z\diff z+\oint_{C_2}\frac1{z-1}\diff z}\\
				\visible<+->{=}&\visible<.->{2\pi i+0+0+2\pi i=4\pi i.}
			\end{align*}
		}\vspace{-\baselineskip}
	\end{solution}
	\endgroup
\end{frame}


\begin{frame}{例: 复合闭路定理的应用}
	\onslide<+->
	\begin{example}
		求 $\displaystyle\int_\Gamma\frac{e^z}z\diff z$, 其中 $\Gamma=C_1+C_2^-$, $C_1:|z|=2, C_2:|z|=1$.
		\vspace{-.8\baselineskip}
		\begin{center}
			\begin{tikzpicture}[scale=.8]
				\filldraw[cstcurve,main,cstfill] (0,0) circle (1.5);
				\draw[cstcurve,main,cstwla] (-1.06,1.06) arc(135:90:1.5);
				\filldraw[cstcurve,second,fill=white] (0,0) circle (0.75);
				\draw[cstcurve,second,cstwra] (-0.75,0) arc(180:130:0.75);
				\draw
					(-1.6,0.8) node[main] {$C_1$}
					(0.8,-0.7) node[second] {$C_2^-$};
				\draw[cstaxis] (-1.8,0)--(1.8,0);
				\draw[cstaxis] (0,-1.8)--(0,1.8);
			\end{tikzpicture}
		\end{center}
		\vspace{-.8\baselineskip}
	\end{example}
	\onslide<+->
	\begin{solution}
		函数 $\dfrac{e^z}z$ 在 $C_1,C_2$ 围城的圆环域内解析.
		\onslide<+->{由复合闭路定理可知 $\displaystyle\int_\Gamma\frac{e^z}z\diff z=0$.}
	\end{solution}
\end{frame}


