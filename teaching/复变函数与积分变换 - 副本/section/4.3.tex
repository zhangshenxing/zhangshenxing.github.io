\section{泰勒级数}

\subsection{泰勒展开的形式与性质}

\begin{frame}{实泰勒级数的特点}
	\onslide<+->
	我们知道, 幂级数在它的收敛域内的和函数是一个解析函数.
	\onslide<+->
	反过来, 解析函数是不是也一定可以在一点展开成幂级数呢? 也就是说是否存在\emph{泰勒级数}展开?

	\onslide<+->
	在高等数学中我们知道, 一个函数即使在一点附近无限次可导, 它的泰勒级数也未必收敛到原函数.
	\onslide<+->
	例如
	\[f(x)=\begin{cases}
	e^{-x^{-2}},&x\neq 0,\\
	0,&x=0.\end{cases}\]
	\onslide<+->
	它处处可导, 但是它在 $0$ 处的各阶导数都是 $0$.
	\onslide<+->
	因此它的泰勒级数是 $0$, 余项恒为 $f(x)$.
	\onslide<+->
	除 $0$ 外它的泰勒级数均不收敛到原函数.
\end{frame}


\begin{frame}{实泰勒级数的特点}
	\onslide<+->
	而即使是泰勒级数能收敛到原函数的情形, 它成立的范围也很难从函数本身读出.
	\onslide<+->
	例如
	\[\dfrac1{1+x}=1-x+x^2-x^3+\cdots,\quad|x|<1.\]
	\onslide<+->
	这可以从 $x=-1$ 是奇点看出.
	\onslide<+->
	而
	\[\dfrac1{1+x^2}=1-x^2+x^4-x^6+\cdots,\quad|x|<1\]
	却并没有奇点.
	\onslide<+->
	为什么它的麦克劳林级数成立的开区间也是 $(-1,1)$?
	\onslide<+->
	这个问题在本节可以得到回答.
\end{frame}


\begin{frame}{泰勒展开的形式}
	\onslide<+->
	设函数 $f(z)$ 在区域 $D$ 解析, $z_0\in D$.
	\onslide<+->
	设 $|z-z_0|$ 小于 $z_0$ 到 $D$ 边界的距离 $d$,
	则存在 $|z-z_0|<r<d$.
	\onslide<+->
	设 $K:|\zeta-z_0|=r$, 则 $K$ 和它的内部包含在 $D$ 中.
	\onslide<+->
	由于 $\abs{\dfrac{z-z_0}{\zeta-z_0}}<1$, 因此
	\[\frac1{\zeta-z}=\frac1{\zeta-z_0}\cdot\frac1{1-\dfrac{z-z_0}{\zeta-z_0}}=\sum_{n=0}^\infty\frac{(z-z_0)^n}{(\zeta-z_0)^{n+1}}.\]

	\onslide<1->
	\begin{center}
		\begin{tikzpicture}
			\filldraw[cstcurve,main,smooth,cstfill] plot coordinates {(-2.25,0) (-1.5,-0.75) (0,-1.5) (1.05,-1.5) (1.35,0) (0,1.2) (-1.5,1.2) (-2.25,0)};
			\draw[cstdash,third,visible on=<2->] (0,0) circle (1);
			\draw[cstcurve,second,visible on=<3->] (0,0) circle (0.8);
			\fill[cstdot,second] (0,0) circle;
			\fill[cstdot,third,visible on=<2->] (0.4,0.4) circle;
			\fill[cstdot,visible on=<3->] (0.6,-0.5) circle;
			\draw[cstcurve,cstra,second,visible on=<3->] (0,0)--(-0.48,-0.64);
			\draw
				(-0.25,0) node[second] {$z_0$}
				(0.2,0.4) node[third,visible on=<2->] {$z$}
				(0,-0.5) node[second,visible on=<3->] {$r$}
				(0.4,-0.3) node[main,visible on=<3->] {$\zeta$};
		\end{tikzpicture}
	\end{center}
\end{frame}


\begin{frame}{泰勒展开的形式}
	\onslide<+->
	故
	\begin{align*}
		f(z)&=\frac1{2\pi i}\oint_K \frac{f(\zeta)}{\zeta-z}\diff\zeta
		\visible<+->{=\frac1{2\pi i}\oint_K f(\zeta)\sum_{n=0}^\infty\frac{(z-z_0)^n}{(\zeta-z_0)^{n+1}}\diff\zeta}\\
		&\visible<+->{=
		\sum_{n=0}^{N-1}\left[\frac1{2\pi i}\oint_K\frac{f(\zeta)\diff\zeta}{(\zeta-z_0)^{n+1}}\right](z-z_0)^n+R_N(z),}\\
		&\visible<+->{=
		\sum_{n=0}^{N-1}\frac{f^{(n)}(z_0)}{n!}(z-z_0)^n+R_N(z),}
	\end{align*}
	\onslide<+->
	其中
	\[
		R_N(z)=\frac1{2\pi i}\oint_Kf(\zeta)\left[\sum_{n=N}^\infty\frac{(z-z_0)^n}{(\zeta-z_0)^{n+1}}\right]\diff\zeta
		=\frac1{2\pi i}\oint_K\frac{f(\zeta)}{\zeta-z}\cdot\left(\frac{z-z_0}{\zeta-z_0}\right)^N\diff\zeta.
	\]
\end{frame}


\begin{frame}{泰勒展开的形式}
	\onslide<+->
	由于 $f(\zeta)$ 在 $D\supseteq K$ 上解析, 从而在 $K$ 上连续且有界.
	\onslide<+->
	设 $|f(\zeta)|\le M,\zeta\in K$,
	\onslide<+->
	那么
	\begin{align*}
		|R_N(z)|&\le\frac 1{2\pi}\oint_K\abs{\frac{f(\zeta)}{\zeta-z}\cdot\left(\frac{z-z_0}{\zeta-z_0}\right)^N}\diff s\\
		&\visible<+->{\le\frac 1{2\pi}\cdot \frac M{r-|z-z_0|}\cdot\abs{\frac{z-z_0}{\zeta-z_0}}^N\cdot 2\pi r\to 0\quad (N\to\infty).}
	\end{align*}
	\onslide<+->
	故
	\[\alertm{f(z)=\sum_{n=0}^\infty\frac{f^{(n)}(z_0)}{n!}(z-z_0)^n},\quad |z-z_0|<d.\]
\end{frame}


\begin{frame}{泰勒展开的成立范围}
	\onslide<+->
	由于幂级数在收敛半径内的和函数是解析的, 因此上述等式成立的圆域不包含奇点.
	\onslide<+->
	故解析函数在 $z_0$ 处\alert{泰勒展开成立的圆域的最大半径是 $\alertm{z_0}$ 到最近奇点的距离}.
	\onslide<+->
	需要注意的是, 泰勒级数的收敛半径是有可能比这个半径更大的:
	\[f(z)=\begin{cases}
	e^z,&z\neq 1;\\ 0,&z=1,
	\end{cases}\qquad f(z)=\suml_{n=0}^\infty \dfrac{z^n}{n!},\quad |z|<1.\]
	\onslide<+->
	\[f(z)=\ln(z-1-i),\qquad f(z)=-\frac1{1+i}\sum_{n=0}^\infty\frac1{n(1+i)^n}z^n,\quad |z|<1.\]
	\onslide<+->
	若并非这两种情形(奇点``可去''), 则收敛半径的确就是前述距离.

	\onslide<+->
	对于
	\[f(z)=\begin{cases}
	e^{-z^{-2}},&z\neq 0,\\
	0,&z=0.\end{cases}\]
	\onslide<+->
	$\lim_{y\to 0}f(iy)=\infty$, 因此 $f(z)$ 在 $0$ 处不连续, 无法在 $0$ 处进行复的泰勒展开.
\end{frame}


\subsection{泰勒展开的计算方法}
\begin{frame}{幂级数展开的唯一性}
	\onslide<+->
	对于 $f(z)=\dfrac1{1+z^2}$,
	\onslide<+->
	它的奇点为 $\pm i$, 所以它的麦克劳林展开成立的半径是 $1$.
	\onslide<+->
	这就解释了为什么函数 $f(x)=\dfrac1{1+x^2}$ 的麦克劳林展开成立的开区间是 $(-1,1)$.

	\onslide<+->
	若 $f(z)$ 在 $z_0$ 附近展开为 $\suml_{n=0}^\infty c_n(z-z_0)^n$,
	\onslide<+->
	则由幂级数的逐项求导性质可知
	\[f^{(n)}(z_0)=\sum_{k=n}^\infty c_k k(k-1)\cdots(k-n+1)(z-z_0)^{k-n}\Big|_{z=z_0}=n!c_n.\]
	\onslide<+->
	所以\alert{解析函数的幂级数展开是唯一的}.
	\onslide<+->
	由此, 解析函数的泰勒展开不仅可以\emph{直接求出各阶导数得到}, 也可以\emph{利用幂级数的运算法则得到}.

	\onslide<+->
	如果函数 $f(z)$ 在一幂级数所有收敛的点处与其和函数相同, 则 $g(z)$ \alert{一定在收敛圆周上有奇点}.
	\onslide<+->
	这是因为一旦 $f(z)$ 在收敛圆周上处处解析, 它就可以在一个半径更大的圆域上泰勒展开成该幂级数.
\end{frame}


\begin{frame}{典型例题: 泰勒展开的计算}
	\beqskip{5pt}
	\onslide<+->
	\begin{example}
		由于 $(e^z)^{(n)}(0)=e^z|_{z=0}=1$,
		\onslide<+->{因此
		\[\emphm{e^z=1+z+\frac{z^2}{2!}+\frac{z^3}{3!}+\cdots=\sum_{n=0}^\infty\frac{z^n}{n!},\quad\forall z.}\]}
		\vspace{-.5\baselineskip}
	\end{example}

	\onslide<+->
	\begin{example}
		由于 $\displaystyle(\cos z)^{(n)}=\cos\left(z+\dfrac{n\pi}2\right)$,
		\onslide<+->{
			\[(\cos z)^{(2n+1)}(0)=0,\quad (\cos z)^{(2n)}(0)=(-1)^n,\]
		}\onslide<+->{因此
			\[\emphm{\cos z=1-\frac{z^2}{2!}+\frac{z^4}{4!}-\frac{z^6}{6!}+\cdots=\sum_{n=0}^\infty(-1)^n\frac{z^{2n}}{(2n)!},\quad\forall z.}\]}
			\vspace{-.5\baselineskip}
	\end{example}
	\endgroup
\end{frame}


\begin{frame}{典型例题: 泰勒展开的计算}
	\onslide<+->
	\begin{example}
		由 $e^z$ 的泰勒展开可得
		\begin{align*}
			\sin z&=\frac{e^{iz}-e^{-iz}}{2i}
			\visible<+->{=\sum_{n=0}^\infty\frac{(iz)^n-(-iz)^n}{2i\cdot n!}}\\
			&\visible<+->{\emphm{=z-\frac{z^3}{3!}+\frac{z^5}{5!}-\cdots}
			\emphm{=\sum_{n=0}^\infty(-1)^n\frac{z^{2n+1}}{(2n+1)!},\quad\forall z.}}
		\end{align*}
		\onslide<+->
		这里, 因为 $\sin z$ 是奇函数, 所以它的麦克劳林展开只有奇数幂次项, 没有偶数幂次项.
	\end{example}
\end{frame}


\begin{frame}{典型例题: 泰勒展开的计算}
	\beqskip{5pt}
	\onslide<+->
	\begin{example}
	求对数函数的主值 $\ln(1+z)$ 的麦克劳林展开.
	\end{example}
	\onslide<+->
	\begin{solution}
	由于 $\ln(1+z)$ 在去掉射线 $z=x\le-1$ 的区域内解析,
	\onslide<+->{因此它在 $|z|<1$ 内解析,
	}\onslide<+->{且
		\[[\ln(1+z)]'=\frac1{1+z}=\sum_{n=0}^\infty(-1)^nz^n,\quad|z|<1.\]
	}\onslide<+->{逐项积分得到
	\begin{align*}
	\ln(1+z)&=\int_0^z\frac1{1+\zeta}\diff\zeta
		\visible<+->{=\int_0^z\sum_{n=0}^\infty(-1)^n\zeta^n\diff\zeta}\\
	&\visible<+->{=\sum_{n=0}^\infty\frac{(-1)^nz^{n+1}}{n+1}}
		\visible<+->{=\sum_{n=1}^\infty\frac{(-1)^{n+1}z^n}{n},\quad|z|<1.}
	\end{align*}}
	\vspace{-.5\baselineskip}
	\end{solution}
	\endgroup
\end{frame}


\begin{frame}{典型例题: 泰勒展开的计算}
	\onslide<+->
	\begin{example}
		本例中幂函数均取主值.
		\onslide<+->{%
		$f(z)=(1+z)^\alpha$ 在去掉射线 $z=x\le -1$ 的区域内解析.
	}\onslide<+->{%
		由于
		\begin{align*}
			f^{(n)}(0)&=\alpha(\alpha-1)\cdots(\alpha-n+1)(1+z)^{\alpha-n}\Big|_{z=0}\\
			&\visible<+->{=\alpha(\alpha-1)\cdots(\alpha-n+1).}
			\end{align*}
		}\onslide<+->{因此
			\begin{align*}
			\emphm{(1+z)^\alpha}&\emphm{=1+\alpha z+\frac{\alpha(\alpha-1)}2z^2+\frac{\alpha(\alpha-1)(\alpha-2)}{3!}z^3+\cdots}\\
			&\emphm{=\sum_{n=0}^\infty\frac{\alpha(\alpha-1)\cdots(\alpha-n+1)}{n!}z^n,\quad |z|<1.}
		\end{align*}}
		\vspace{-.5\baselineskip}
	\end{example}
\end{frame}

\begin{frame}{典型例题: 泰勒展开的计算}
	\onslide<+->
	当 $\alpha=n$ 是正整数时, 上述麦克劳林展开的 $>n$ 幂次项系数为零, 
	\onslide<+->
	从而
	\[(1+z)^n=\sum_{k=0}^n \mathrm{C}_n^k z^k,\]
	此即牛顿二项式展开.

	\onslide<+->
	\begin{example}
		将 $\dfrac1{(1+z)^2}$ 展开成 $z$ 的幂级数.
	\end{example}

	\onslide<+->
	\begin{solution}
		由幂函数展开可知当 $|z|<1$ 时,
		\[(1+z)^{-2}=\sum_{n=0}^\infty \frac{(-2)(-3)\cdots(-1-n)}{n!}z^n
		\visible<+->{=\sum_{n=0}^\infty (-1)^n(n+1)z^n.}\]
		\vspace{-.5\baselineskip}
	\end{solution}
\end{frame}


\begin{frame}{典型例题: 泰勒展开的计算}
	\onslide<+->
	\begin{solution}[另解]
		由于 $\dfrac1{(1+z)^2}$ 的奇点为 $z=-1$, 因此它在 $|z|<1$ 内解析.
		\onslide<+->{由于
			\[\frac1{1+z}=1-z+z^2-z^3+\cdots=\sum_{n=0}^\infty (-1)^nz^n,\]
		}\onslide<+->{因此
			\[
			\frac1{(1+z)^2}=-\left(\frac1{1+z}\right)'
			\visible<+->{=-\sum_{n=1}^\infty(-1)^n nz^{n-1}}
			\visible<+->{=\sum_{n=0}^\infty(-1)^n (n+1)z^n,\quad |z|<1.}
			\]
		}
		\vspace{-\baselineskip}
	\end{solution}
	\onslide<+->
	一般地, 我们有
	\[\frac1{(1-\lambda z)^k}=\sum_{n=0}^\infty(n+k-1)\cdots(n+2)(n+1)z^n,\ |z|<\frac1{|\lambda|}.\]
\end{frame}


\begin{frame}{典型例题: 泰勒展开的计算}
	\onslide<+->
	\begin{example}
		求 $\dfrac1{3z-2}$ 的麦克劳林展开.
	\end{example}

	\onslide<+->
	\begin{solution}
		由于 $\dfrac1{3z-2}$ 的奇点为 $z=\dfrac23$, 因此它在 $|z|<\dfrac23$ 内解析.
		\onslide<+->{此时
		\begin{align*}
			\frac1{3z-2}&=-\half\cdot\frac1{1-\dfrac{3z}2}
				\visible<+->{=-\half\sum_{n=0}^\infty\left(\frac{3z}2\right)^n}\\
			&\visible<+->{=-\sum_{n=0}^\infty\frac{3^n}{2^{n+1}}z^n,\quad|z|<\frac23.}
		\end{align*}}
		\vspace{-.5\baselineskip}
	\end{solution}
\end{frame}


\begin{frame}{典型例题: 泰勒展开的计算\noexer}
	\beqskip{3pt}
	\onslide<+->
	\begin{exercise}
		求 $\dfrac1{1-3z+2z^2}$ 的麦克劳林展开.
	\end{exercise}

	\onslide<+->
	\begin{answer}
	\[
		\frac1{1-3z+2z^2}=\frac{2}{1-2z}-\frac1{1-z}
		=\sum_{n=0}^\infty(2^{n+1}-1)z^n,\quad |z|<\half .
	\]
	\end{answer}

	\onslide<+->
	有理函数展开为真分式形式若用待定系数法总略显繁琐, 我们现介绍一种方法.
	\onslide<+->
	设
	\[f(z)=\dfrac{1}{(z-1)(z-2)(z+2)}=\frac{a}{z-1}+\frac{b}{z-2}+\frac{c}{z+2},\]
	\onslide<+->
	\[a=\frac1{2\pi i} \oint_{|z-1|=0.1}f(z)\diff z=\dfrac{1}{(z-2)(z+2)}\Big|_{z=1}=-\frac13.\]
	\onslide<+->
	类似可得 $b=\dfrac14,c=\dfrac1{12}$.
	\endgroup
\end{frame}



\begin{frame}{典型例题: 泰勒展开的计算\noexer}
	\onslide<+->
	对于分母有重根的情形, 例如
	\onslide<+->
	\[f(z)=\dfrac{1}{(z-1)^2(z-2)^3}=\frac{a}{z-1}+\frac{b}{(z-1)^2}+\frac{c}{z-2}+\frac{d}{(z-2)^2}+\frac{e}{(z-2)^3},\]
	\onslide<+->
	\[a=\frac1{2\pi i} \oint_{|z-1|=0.1}f(z)\diff z=\left(\dfrac{1}{(z-2)^3}\right)'\Big|_{z=1}=-3,\]
	\onslide<+->
	\[b=\frac1{2\pi i} \oint_{|z-1|=0.1}(z-1)f(z)\diff z=\dfrac{1}{(z-2)^3}\Big|_{z=1}=-1.\]
	\onslide<+->
	类似可得 $c=3,d=-2,e=1$, 只是我们需要计算高阶导数.
	\onslide<+->
	因此
	\[f(z)=\sum_{n=0}^\infty\left(3-(n+1)+\frac{-\frac32-\frac12(n+1)-\frac18(n+2)(n+1)}{2^n}\right)z^n,\quad |z|<1.\]
\end{frame}

