\section{留数}

\subsection{留数定理}

\begin{frame}{留数}
	\onslide<+->
	\begin{definition}
			设 $z_0$ 为 $f(z)$ 的孤立奇点, $f(z)$ 在它的某个去心邻域内的洛朗展开为
			\[f(z)=\cdots+\frac{c_{-1}}{z-z_0}+c_0+c_1(z-z_0)+\cdots.\]
		\onslide<+->{称
			\[\alertm{\Res[f(z),z_0]:=c_{-1}=\frac1{2\pi i}\oint_Cf(z)\diff z}\]
			为函数 \emph{$f(z)$ 在 $z_0$ 的留数}, 其中 $C$ 为该去心邻域中绕 $z_0$ 的一条闭路.
		}
	\end{definition}

	\onslide<+->
	可以看出, 知道留数之后可以用来计算积分.
\end{frame}


\begin{frame}{留数定理}
	\onslide<+->
	\begin{algorithm}{复变函数积分计算方法 III: 留数定理}
		若 $f(z)$ 在闭路 $C$ 上解析, 在 $C$ 内部的奇点为 $z_1,z_2,\dots,z_n$, 则
		\[\oint_Cf(z)\diff z=2\pi i\sum_{k=1}^n\Res[f(z),z_k].\]
	\end{algorithm}

	\onslide<+->
	\begin{proof}
		\begin{center}
			\begin{tikzpicture}[scale=.8]
				\filldraw[cstcurve,rounded corners=0.4cm,main,cstfill] (-3,-1) rectangle (3,1);
				\draw[cstcurve,main,cstwra] (3,-0.2)--(3,0.1);
				\filldraw[cstcurve,white,draw=second] (-2,0.2) circle (0.5);
				\draw[cstcurve,second,cstwra] (-2,0.7) arc(90:135:0.5);
				\fill[cstdot] (-2,0.2) circle;
				\filldraw[cstcurve,white,draw=second] (0.2,-0.2) circle (0.5);
				\draw[cstcurve,second,cstwra] (0.2,0.3)arc(90:135:0.5);
				\fill[cstdot] (0.2,-0.2) circle;
				\filldraw[cstcurve,white,draw=second] (2,0.2) circle (0.5);
				\draw[cstcurve,second,cstwra] (2,0.7)arc(90:135:0.5);
				\fill[cstdot] (2,0.2) circle;
				\draw
					(3.4,0) node[main] {$C$}
					(-1.3,-0.2) node[second] {$C_1$}
					(0.2,0.5) node[second] {$C_2$}
					(2.4,-0.5) node[second] {$C_3$}
					(-2,-0.1) node {$z_1$}
					(0.2,-0.5) node {$z_2$}
					(2,-0.1) node {$z_3$};
			\end{tikzpicture}
		\end{center}
		\vspace{-.3\baselineskip}
		\onslide<+->{%
			由复闭路定理, $\displaystyle\oint_Cf(z)\diff z=\sum_{k=1}^n\oint_{C_k}f(z)\diff z
			=2\pi i\sum_{k=1}^n\Res[f(z),z_k]$.\qedhere
		}
	\end{proof}
\end{frame}


\subsection{留数的计算方法}

\begin{frame}{可去奇点的留数}
	\onslide<+->
	若 $z_0$ 为 $f(z)$ 的可去奇点, 则显然 $\Res[f(z),z_0]=0$.

	\onslide<+->
	\begin{example}
		$f(z)=\dfrac{z^3(e^z-1)^2}{\sin z^4}$.
		\onslide<+->{%
		由于 $0$ 是分子的 $5$ 阶零点, 分母的 $4$ 阶零点, 因此 $z=0$ 是 $f(z)$ 的可去奇点.
		}\onslide<+->{%
		故
		\[\Res[f(z),0]=0.\]
		}
	\end{example}
\end{frame}


\begin{frame}{本性奇点的留数}
	\onslide<+->
	若 $z_0$ 为 $f(z)$ 的本性奇点, 一般只能从定义计算.

	\onslide<+->
	\begin{example}
		$f(z)=z^4\sin\dfrac1z$.
	\onslide<+->{%
		由于
		\[f(z)=z^4\sum_{n=0}^\infty(-1)^n\frac{z^{-2n-1}}{(2n+1)!}
		=z^3-\frac z{3!}+\frac1{5!z}+\cdots\]
	}
	\onslide<+->{%
		因此 \[\Res[f(z),0]=\frac1{120}.\]
	}
	\end{example}
\end{frame}


\begin{frame}{极点的留数计算方法}
	\onslide<+->
	设 $z_0$ 为 $f(z)$ 的极点.

	\onslide<+->
	\begin{algorithm}{极点留数计算公式 I}
		如果 $z_0$ 是 $\le m$ 阶极点或可去奇点, 那么
		\[\Res[f(z),z_0]=\frac1{(m-1)!}\lim_{z\to z_0}\frac{\diff^{m-1}}{\diff z^{m-1}}[(z-z_0)^mf(z)].\]
	\end{algorithm}

	\onslide<+->
	\begin{algorithm}{极点留数计算公式 II}
		如果 $z_0$ 是一阶极点或可去奇点, 那么
		\[\Res[f(z),z_0]=\lim\limits_{z\to z_0}(z-z_0)f(z).\]
	\end{algorithm}
\end{frame}


\begin{frame}{极点的留数计算方法}
	\onslide<+->
	\begin{proof}
		设
		\begin{align*}
			f(z)&=c_{-m}(z-z_0)^{-m}+\cdots+c_{-1}(z-z_0)^{-1}+c_0+\cdots,\\
			g(z)&=c_{-m}+\cdots+c_{-1}(z-z_0)^{m-1}+c_0(z-z_0)^m+\cdots,
		\end{align*}
	\onslide<+->{%
		则 $g(z)=(z-z_0)^mf(z)$.
	}%
	\onslide<+->{%
		由泰勒展开系数与函数导数的关系可知
		\[\Res[f(z),z_0]=c_{-1}=\dfrac1{(m-1)!}g^{(m-1)}(z_0).\qedhere\]
	}
	\end{proof}
\end{frame}


\begin{frame}{典型例题: 留数的计算}
	\onslide<+->
	\begin{example}
		求 $\Res\left[\dfrac{e^z}{z^n},0\right]$.
	\end{example}

	\onslide<+->
	\begin{solution}
			显然 $0$ 是 $n$ 阶极点,
		\onslide<+->{\begin{align*}
				\Res\left[\frac{e^z}{z^n},0\right]&=\frac1{(n-1)!}\lim_{z\to0}(e^z)^{(n-1)}\\
				&\visible<+->{=\frac1{(n-1)!}\lim_{z\to0}e^z=\frac1{(n-1)!}.}
			\end{align*}
		}
	\end{solution}
\end{frame}


\begin{frame}{典型例题: 留数的计算}
	\onslide<+->
	\begin{example}
		求 $\Res\left[\dfrac{z-\sin z}{z^6},0\right]$.
	\end{example}

	\onslide<+->
	\begin{solution}
			因为 $z=0$ 是 $z-\sin z$ 的三阶零点,
		\onslide<+->{所以是 $\dfrac{z-\sin z}{z^6}$ 的三阶极点.
		}\onslide<+->{如果用公式
			\[\Res\left[\frac{z-\sin z}{z^6},0\right]
			=\frac1{2!}\lim_{z\to0}\left(\frac{z-\sin z}{z^3}\right)''\]
			计算会很繁琐.
		}
		\vspace{-.5\baselineskip}
		\onslide<+->{
		\[
			\Res\left[\frac{z-\sin z}{z^6},0\right]=\frac1{5!}\lim_{z\to0}(z-\sin z)^{(5)}
			\visible<+->{=\frac1{5!}\lim_{z\to0}(-\cos z)=-\frac1{120}.}
		\]}
		\vspace{-\baselineskip}
	\end{solution}
\end{frame}


\begin{frame}{典型例题: 留数的计算}
	\onslide<+->
	\begin{exercise}
			求 $\Res\left[\dfrac{e^z-1}{z^5},0\right]=$\fillblankframe[2cm][2mm]{$\dfrac1{24}$}.
	\end{exercise}
\end{frame}


\begin{frame}{留数的计算方法}
	\onslide<+->
	\begin{algorithm}{极点留数计算公式 III}
		设 $P(z),Q(z)$ 在 $z_0$ 解析且 $z_0$ 是 $Q$ 的一阶零点, 则
		\[\Res\left[\frac{P(z)}{Q(z)},z_0\right]=\frac{P(z_0)}{Q'(z_0)}.\]
	\end{algorithm}

	\onslide<+->
	\begin{proof}
			不难看出 $z_0$ 是 $f(z)=\dfrac{P(z)}{Q(z)}$ 的一阶极点或可去奇点.
		\onslide<+->{因此
			\begin{align*}
				&\Res[f(z),z_0]=\lim_{z\to z_0}(z-z_0)f(z)\\
				\visible<+->{=}&\visible<.->{\lim_{z\to z_0}\frac{P(z)}{\dfrac{Q(z)-Q(z_0)}{z-z_0}}}
				\visible<+->{=\frac{P(z_0)}{\lim\limits_{z\to z_0}\dfrac{Q(z)-Q(z_0)}{z-z_0}}=\frac{P(z_0)}{Q'(z_0)}.\qedhere}
			\end{align*}
		}
		\vspace{-\baselineskip}
	\end{proof}
\end{frame}


\begin{frame}{典型例题: 留数的计算}
	\onslide<+->
	\begin{example}
		求 $\Res\left[\dfrac{z}{z^8-1},\dfrac{1+i}{\sqrt2}\right]$.
	\end{example}

	\onslide<+->
	\begin{solution}
			由于 $z=\dfrac{1+i}{\sqrt2}$ 是分母的 $1$ 阶零点,
		\onslide<+->{因此
			\[\Res\left[\frac z{z^8-1},\frac{1+i}{\sqrt2}\right]
			=\frac z{(z^8-1)'}\Big|_{z=\frac{1+i}{\sqrt2}}
			=\frac z{8z^7}\Big|_{z=\frac{1+i}{\sqrt2}}
			=\frac i8.\]
		}
	\end{solution}
\end{frame}


\begin{frame}{例: 留数的应用}
	\beqskip{5pt}
	\onslide<+->
	\begin{example}
		计算积分 $\displaystyle\oint_{|z|=2}\frac{e^z}{z(z-1)^2}\diff z$.
	\end{example}

	\onslide<+->
	\begin{solution}
			$f(z)=\dfrac{e^z}{z(z-1)^2}$ 在 $|z|<2$ 内有奇点 $z=0,1$.
		\onslide<+->{%
		\begin{align*}
			\Res[f(z),0]&=\lim_{z\to0}\frac{e^z}{(z-1)^2}=1,\\
			\visible<+->{\Res[f(z),1]}&\visible<.->{=\lim_{z\to1}\left(\frac{e^z}z\right)'=\lim_{z\to1}\frac{e^z(z-1)}{z^2}=0,}
		\end{align*}
		}\onslide<+->{%
		\[\oint_{|z|=2}\frac{e^z}{z(z-1)^2}\diff z
			=2\pi i\bigl[\Res[f(z),0]+\Res[f(z),1]\bigr]
			=2\pi i.\]
		}
		\vspace{-0.7\baselineskip}
	\end{solution}
	\endgroup
\end{frame}


\subsection{在 \texorpdfstring{$\infty$}{∞} 的留数*}

\begin{frame}{在 $\infty$ 的留数\noexer}
	\onslide<+->
	\begin{definition}
		设 $\infty$ 为 $f(z)$ 的孤立奇点, $f(z)$ 在某个 $R<|z|<+\infty$ 内的洛朗展开为
		\[f(z)=\cdots+c_{-1}z^{-1}+c_0+c_1z+\cdots\]
		称
		\[\emphm{\Res[f(z),\infty]:=-c_{-1}=\frac1{2\pi i}\oint_{C^-}f(z)\diff z}\]
		为函数 \emph{$f(z)$ 在 $\infty$ 的留数}, 其中 $C$ 为该圆环域中绕 $0$ 的一条闭路.
	\end{definition}

	\onslide<+->
	由于
	\[f\left(\frac1z\right)\frac1{z^2}=\cdots+\frac{c_1}{z^3}+\frac{c_0}{z^2}+\frac{c_{-1}}z+c_{-2}+\cdots\]
	\onslide<+->
	因此 $\displaystyle\alertm{\Res[f(z),\infty]=-\Res\left[f\left(\frac1z\right)\frac1{z^2},0\right]}$.
\end{frame}


\begin{frame}{留数之和为 $0$\noexer}
	\onslide<+->
	需要注意的是, 和普通复数不同, \alert{即便 $\infty$ 是可去奇点, 也不意味着 $\Res[f(z),\infty]=0$}.

	\onslide<+->
	\begin{theorem}
		如果 $f(z)$ 只有有限个奇点, 那么 $f(z)$ 在扩充复平面内各奇点处的留数之和为 $0$.
	\end{theorem}

	\onslide<+->
	\begin{proof}
			设闭路 $C$ 内部包含除 $\infty$ 外所有奇点 $z_1,\dots,z_n$.
		\onslide<+->{由留数定理
			\[-2\pi i\Res[f(z),\infty]=\oint_C f(z)\diff z=2\pi i\sum_{k=1}^n\Res[f(z),z_k].\]
		}\onslide<+->{故 $\suml_{k=1}^n\Res[f(z),z_k]+\Res[f(z),\infty]=0$.\qedhere
		}
	\end{proof}
\end{frame}


\begin{frame}{例: 留数的应用\noexer}
	\onslide<+->
	\begin{example}
		求 $\displaystyle\oint_{|z|=2}f(z)\diff z$, 其中 $f(z)=\dfrac{\sin(1/z)}{(z+i)^{10}(z-1)(z-3)}$.
	\end{example}

	\onslide<+->
	\begin{solution*}
		$f(z)$ 在 $|z|<2$ 内有奇点 $1,-i,0$,
		\onslide<+->{%
		其中 $0$ 是本性奇点, 它的留数不易求得.
		}\onslide<+->{%
		而 $-i$ 是 $10$ 阶极点, 它的留数也难以计算.
		}
		
		\onslide<+->{%
		$f(z)$ 在 $|z|>2$ 内只有奇点 $3,\infty$.
		}\onslide<+->{%
		\[\Res[f(z),3]=\lim_{z\to3}(z-3)f(z)=\frac1{2(3+i)^{10}}\sin\frac13.\]
		}\vspace{-\baselineskip}
	\end{solution*}
\end{frame}


\begin{frame}{例: 留数的应用\noexer}
	\onslide<+->
	\begin{solution}[续解]
		\begin{align*}
			\Res[f(z),\infty]&=-\Res\left[f\left(\frac1z\right)\frac1{z^2},0\right]\\
			&=-\Res\left[\frac{z^{10}\sin z}{(1+iz)^{10}(1-z)(1-3z)},0\right]=0.
		\end{align*}
	\onslide<+->{
		\begin{align*}
			\oint_{|z|=2}f(z)\diff z
			&=2\pi i\bigl[\Res[f(z),-i]+\Res[f(z),1]+\Res[f(z),0]\bigr]\\
			&\visible<+->{=-2\pi i\bigl[\Res[f(z),3]+\Res[f(z),\infty]\bigr]=-\frac{\pi i}{(3+i)^{10}}\sin\frac13.}
		\end{align*}
	}
	\end{solution}
\end{frame}


\begin{frame}{积分的计算方法汇总}
\begin{center}
\begin{tikzpicture}[node distance=25pt]
	\node at (4.5,0.5) [cstnode2,visible on=<3->]	(end1){求出 $f(z)$ 的原函数 $F(z)$ 得到 $\displaystyle\int_Cf(z)\diff z=F(b)-F(a)$};
	\node at (0,2.2) [cstnode,visible on=<3->]	(isanalytic){$f(z)$ 解析};
	\node at (4.5,2.2) [cstnode2,align=center, visible on=<4->]	(end2){设曲线方程为 $z(t)$, 则\\
积分$\displaystyle=\int_a^bf(z)z'(t)\diff t$\\
可能需要分段计算};
	\node at (9,2.2) [cstnode2,align=center, visible on=<9->]	(end4){闭路外奇点留数之和\\并乘 $-2\pi i$*};
	\node at (0,4.5) [cstnode,visible on=<2->]	(isclosed){是闭路};
	\node at (4.5,4.5) [cstnode,visible on=<5->]	(issingle){内(外)部只有孤立奇点};
	\node at (9,4.5) [cstnode,align=center, visible on=<7->]	(ismany){闭路内部和外部\\孤立奇点数量};
	\node at (1.5,6.3) [cstnode1]  (integral){定积分 $\displaystyle\int_Cf(z)\diff z$ 的计算};
	\node at (9,6.3) [cstnode2,align=center, visible on=<8->]	(end3){闭路内奇点留数之和\\并乘 $2\pi i$};

	\draw[cstmra,fourth,visible on=<2->] (integral.-160) -- (isclosed);
	\draw[cstmra,fourth,visible on=<3->] (isanalytic) -- node[left]{是} (end1.173);
	\draw[cstmra,fourth,visible on=<5->] (isclosed) -- node[above]{是} (issingle);
	\draw[cstmra,fourth,visible on=<7->] (issingle) -- node[above]{是} (ismany);
	\draw[cstmra,fourth,visible on=<3->] (isclosed) -- node[left]{否} (isanalytic);
	\draw[cstmra,fourth,visible on=<6->] (issingle) -- node[left]{否} (end2);
	\draw[cstmra,fourth,visible on=<4->] (isanalytic) -- node[above]{否} (end2);
	\draw[cstmra,fourth,visible on=<8->] (ismany) -- node[left]{闭路内易计算} (end3);
	\draw[cstmra,fourth,visible on=<9->] (ismany) -- node[left]{闭路外易计算} (end4);
\end{tikzpicture}
\end{center}
\end{frame}


\begin{frame}{例: 留数在有理函数分解中的应用}
	\onslide<+->
	在求有理函数的洛朗展开, 以及之后在求有理函数的拉普拉斯逆变换时, 我们需要将一个有理函数表达为分母只有一个零点的有理函数之和.
	\onslide<+->
	例如:
	\[\frac{z-3}{(z+1)(z-1)^2}=\frac1{z-1}-\frac1{(z-1)^2}-\frac1{z+1}.\]
	\onslide<+->
	我们将之前所使用的利用柯西积分公式的方法翻译为留数的语言.
\end{frame}


\begin{frame}{例: 留数在有理函数分解中的应用}
	\onslide<+->
	\begin{solution}
			设 $\displaystyle f(z)=\frac{z-3}{(z+1)(z-1)^2}=\frac a{z-1}+\frac b{(z-1)^2}+\frac c{z+1}$,
		\onslide<+->{则
			\begin{align*}
				a&=\Res[f(z),1]=\left(\frac{z-3}{z+1}\right)'\Big|_{z=1}=\frac 4{(z+1)^2}\Big|_{z=1}=1,\\
				b&=\Res[(z-1)f(z),1]=\frac{z-3}{z+1}\Big|_{z=1}=-1,\\
				c&=\Res[f(z),-1]=\frac{z-3}{(z-1)^2}\Big|_{z=-1}=-1.
			\end{align*}
		}\onslide<+->{故 $\displaystyle f(z)=\frac1{z-1}-\frac1{(z-1)^2}-\frac1{z+1}$.
		}
	\end{solution}
\end{frame}

