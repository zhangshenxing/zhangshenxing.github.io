\section{原函数和不定积分}

\subsection{原函数}

\begin{frame}{原函数的存在性}
	\onslide<+->
	设 $f(z)$ 在单连通区域 $D$ 内解析, $C$ 是 $D$ 内一条起于 $z_0$ 终于 $z$ 的曲线.
	\onslide<+->
	由柯西-古萨定理可知, 积分 $\displaystyle\int_Cf(\zeta)\diff \zeta$ 与路径无关, 只与 $z_0,z$ 有关.
	\onslide<+->
	因此我们也将其记为 $\displaystyle\int_{z_0}^zf(\zeta)\diff\zeta$.

	\onslide<+->
	对于任意固定的 $z_0\in D$, 定义
	\[F(z)=\int_{z_0}^zf(\zeta)\diff\zeta.\]
\end{frame}


\begin{frame}{原函数的存在性}
	\beqskip{0pt}
	\onslide<+->
	\begin{theorem}
		$F(z)$ 是 $D$ 内的解析函数, 且 $F'(z)=f(z)$.
	\end{theorem}
	\onslide<+->
	\begin{solution}[证明]
		\begin{center}
			\begin{tikzpicture}
				\fill[cstcurve,main,rounded corners=0.5cm,cstfill] (-2.5,-0.8) rectangle (2,1);
				\draw[cstcurve,main] (0,0) circle(0.7);
				\draw[cstcurve,third] (-2,0)to [bend left](0,0);
				\draw[cstcurve,third,visible on=<2->] (0,0)--(0.4,0.4);
				\fill[cstdot,third] (-2,0) circle;
				\fill[cstdot,third] (0,0) circle;
				\fill[cstdot,third,visible on=<2->] (0.4,0.4) circle;
				\draw
					(-2,-0.3) node[third] {$z_0$}
					(0,-0.3) node[third] {$z$}
					(1.1,0.7) node[third,visible on=<2->] {$z+\Delta z$};
			\end{tikzpicture}
		\end{center}
		以 $z$ 为中心作一包含在 $D$ 内的圆 $K$,
		\onslide<+->{%
			取 $|\Delta z|$ 小于 $K$ 的半径.
		}\onslide<+->{%
			那么
			\[
				F(z+\Delta z)-F(z)=\int_{z_0}^{z+\Delta z}f(\zeta)\diff\zeta-\int_{z_0}^zf(\zeta)\diff\zeta
				\visible<+->{=\int_z^{z+\Delta z}f(\zeta)\diff\zeta.}
			\]
		}\onslide<+->{%
			容易知道
			$\displaystyle\int_z^{z+\Delta z}f(z)\diff\zeta=f(z)\int_z^{z+\Delta z}\diff\zeta=f(z)\Delta z$.
		}\onslide<+->{%
			我们需要比较上述两个积分, 其中 $z$ 到 $z+\Delta z$ 取直线.
		}
	\end{solution}
	\endgroup
\end{frame}


\begin{frame}{原函数的存在性}
	\onslide<+->
	\begin{proof}[续证]
		由于 $f(z)$ 解析, 因此连续.
		\onslide<+->{$\forall\varepsilon>0,\exists\delta>0$ 使得当 $|\zeta-z|<\delta$ 时, $z$ 落在 $K$ 中且 $|f(\zeta)-f(z)|<\varepsilon$.
		}\onslide<+->{当 $|\Delta z|<\delta$ 时, 由长大不等式
			\begin{align*}
			\abs{\frac{F(z+\Delta z)-F(z)}{\Delta z}-f(z)}
			&\visible<+->{=\abs{\int_z^{z+\Delta z}\frac{f(\zeta)-f(z)}{\Delta z}\diff \zeta}}\\
			&\visible<+->{\le\frac{\varepsilon}{|\Delta z|}\cdot|\Delta z|=\varepsilon.}
			\end{align*}
		}\onslide<+->{由于 $\varepsilon$ 是任意的, 因此
		\[f(z)=\lim_{\Delta z\to 0}\frac{F(z+\Delta z)-F(z)}{\Delta z}=F'(z).\qedhere\]}
	\end{proof}
\end{frame}


\subsection{牛顿-莱布尼兹定理}

\begin{frame}{牛顿-莱布尼兹定理}

	\onslide<+->
	如果 $D$ 上的解析函数 $G(z)$ 满足 $G'(z)=f(z)$, 则称 $G(z)$ 是 $f(z)$ 的一个\emph{原函数}.
	\onslide<+->
	由于导函数为 $0$ 的解析函数只能是常值函数,
	\onslide<+->
	因此 $\displaystyle G(z)=\int_{z_0}^zf(\zeta)\diff \zeta+C$.
	\onslide<+->
	我们称之为 $f(z)$ 的\emph{不定积分}, 记为 \emph{$\displaystyle\int f(z)\diff z$}.

	\onslide<+->
	\begin{algorithm}{复变函数积分计算方法II}
		设 $f(z)$ 在单连通区域 $D$ 上解析, $z_1$ 至 $z_2$ 的积分路径落在 $D$ 内, 则
		\[
			\int_{z_1}^{z_2}f(z)\diff z=F(z)\Big|_{z_1}^{z_2}=F(z_2)-F(z_1),\]
		其中 $F(z)$ 是 $f(z)$ 的一个原函数.
	\end{algorithm}

	\onslide<+->
	复变函数和实变函数的牛顿-莱布尼兹定理的差异在哪呢?
	\onslide<+->
	复变情形要求是\alert{单连通区域上解析函数}, 实变情形要求是\alert{闭区间上连续函数}.
\end{frame}


\begin{frame}{典型例题: 利用原函数求积分}
	\onslide<+->
	\begin{example}
		求 $\displaystyle\int_{z_0}^{z_1}z\diff z$.
	\end{example}

	\onslide<+->
	\begin{solution}
		由于 $f(z)=z$ 处处解析,
		\onslide<+->{%
			且 $\displaystyle\int z\diff z=\half  z^2+C$,
		}\onslide<+->{%
			因此
			\[
				\int_{z_0}^{z_1}z\diff z=\half z^2\big|_{z_0}^{z_1}=\half (z_1^2-z_0^2).
			\]
		}\vspace{-.5\baselineskip}
	\end{solution}
	\onslide<+->
	因此之前的例子中 $\displaystyle\int_0^{3+4i}z\diff z=-\frac72+12i$, 无论从 $0$ 到 $3+4i$ 的路径如何.
\end{frame}


\begin{frame}{典型例题: 利用原函数求积分}
	\onslide<+->
	\begin{example}
		求 $\displaystyle\int_0^{\pi i}z\cos z^2\diff z$.
	\end{example}

	\onslide<+->
	\begin{solution}
		由于 $f(z)=z\cos z^2$ 处处解析,
		\onslide<+->{%
			且
			\[
				\int z\cos z^2\diff z=\half\int \cos z^2\diff z^2=\half\sin z^2+C,
			\]
		}\onslide<+->{%
			因此
			\[
				\int_0^{\pi i}z\cos z^2\diff z=\half\sin z^2\big|_0^{\pi i}=-\half\sin \pi^2.
			\]
		}\vspace{-.5\baselineskip}
	\end{solution}

	\onslide<+->
	这里我们使用了\alert{凑微分法}.
\end{frame}


\begin{frame}{典型例题: 利用原函数求积分}
	\onslide<+->
	\begin{example}
		求 $\displaystyle\int_0^i z\cos z\diff z$.
	\end{example}

	\onslide<+->
	\begin{solution}
		由于 $f(z)=z\cos z$ 处处解析,
		\onslide<+->{%
			且
			\[
				\int z\cos z\diff z
				=\int z\diff(\sin z)
				=z\sin z-\int \sin z\diff z
				\visible<+->{=z\sin z+\cos z+C,}
			\]
		}\onslide<+->{%
			因此
			\[
				\int_0^i z\cos z\diff z
				=(z\sin z+\cos z)\big|_0^i
				\visible<+->{=i\sin i+\cos i-1=e^{-1}-1.}
			\]
		}\vspace{-.5\baselineskip}
	\end{solution}
	\onslide<+->
	这里我们使用了\alert{分部积分法}.
\end{frame}


\begin{frame}{典型例题: 利用原函数求积分}
	\onslide<+->
	\begin{example}
		求 $\displaystyle\int_1^{1+i} z e^z\diff z$.
	\end{example}
	\onslide<+->
	\begin{solution}
		由于 $f(z)=ze^z$ 处处解析,
		\onslide<+->{%
			且 $\displaystyle\int z e^z\diff z=\int z\diff e^z=ze^z-\int e^z\diff z=(z-1)e^z+C$,
		}\onslide<+->{%
			因此 $\displaystyle \int_1^{1+i} z e^z\diff z=(z-1)e^z\big|_1^{1+i}
			\visible<+->{=ie^{1+i}=e(-\sin 1+i\cos 1)}$.
		}
	\end{solution}
	\onslide<+->
	\begin{exercise}
		求 $\displaystyle\int_0^1 z\sin z\diff z=$\fillblankframe[4cm]{$\sin 1-\cos 1$}.
	\end{exercise}
\end{frame}


\begin{frame}{典型例题: 利用原函数求积分}
	\beqskip{0pt}
	\onslide<+->
	\begin{example}
		求 $\displaystyle\int_C(2z^2+8z+1)\diff z$, 其中 $C$ 是摆线
		$\displaystyle\begin{cases}
		x=a(\theta-\sin\theta),& \\ y=a(1-\cos\theta),
		\end{cases} 0\le \theta\le 2\pi.$
		\vspace{-\baselineskip}
		\begin{center}
			\begin{animateinline}[width=9cm]{10}
				\begin{tikzpicture}
					\draw[cstaxis, thick](-1.5,0)--(7.5,0);
					\draw[cstaxis, thick](0,0)--(0,2.5);
					\draw[cstcurve,main,smooth,domain=0:360] plot ({1*(pi/180*\x-sin(\x))},{1*(1-cos(\x))});
				\end{tikzpicture}
				\newframe
				\multiframe{37}{r=0+10}{
					\begin{tikzpicture}
						\draw[cstaxis, thick](-1.5,0)--(7.5,0);
						\draw[cstaxis, thick](0,0)--(0,2.5);
						\draw[cstcurve,second] ({1*(pi/180*\r)},1) circle (1);
						\fill[cstdot,main] ({1*(pi/180*\r-sin(\r))},{1*(1-cos(\r))}) circle;
						\draw[cstcurve,main,smooth,domain=0:360] plot ({1*(pi/180*\x-sin(\x))},{1*(1-cos(\x))});
					\end{tikzpicture}
				}
			\end{animateinline}
		\end{center}
	\end{example}
	\onslide<+->
	\begin{solution}
		由于 $f(z)=2z^2+8z+1$ 处处解析,
		\onslide<+->{%
			因此
			\[
				\text{原积分}=\int_0^{2\pi a}(2z^2+8z+1)\diff z
				\visible<+->{=\left(\frac23z^3+4z^2+z\right)\bigg|_0^{2\pi a}=\frac{16}3\pi^3a^3+16\pi^2a^2+2\pi a.}
			\]
		}
	\end{solution}
	\endgroup
\end{frame}


\begin{frame}{典型例题: 利用原函数求积分}
	\beqskip{3pt}
	\onslide<+->
	\begin{example}
		设 $C$ 为沿着 $|z|=1$ 从 $1$ 到 $i$ 的逆时针圆弧, 求 $\displaystyle\int_C\frac{\ln(z+1)}{z+1}\diff z$.
	\end{example}

	\onslide<+->
	\begin{solution}
		函数 $f(z)=\dfrac{\ln(z+1)}{z+1}$ 在单连通区域 $\Re z>-1$ 内解析.
		\onslide<+->{%
			\[\int\frac{\ln(z+1)}{z+1}\diff z
			=\int\ln(z+1)\diff[\ln(z+1)]=\half\ln^2(z+1)+C.\]
		}\onslide<+->{%
			因此
			\begin{align*}
				\int_C\frac{\ln(z+1)}{z+1}\diff z&=\half\ln^2(z+1)\big|_1^i
				\visible<+->{=\half\left[\ln^2(1+i)-\ln^22\right]}\\
				&\visible<+->{=\half\biggl(\Bigl(\ln\sqrt2+\frac\pi4i\Bigr)^2-\ln^22\biggr)
				=-\frac{\pi^2}{32}-\frac38\ln^22+\frac{\pi\ln2}{8}i.}
			\end{align*}
		}
	\end{solution}
	\endgroup
\end{frame}


