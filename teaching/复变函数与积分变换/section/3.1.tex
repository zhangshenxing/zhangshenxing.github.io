\section{复变函数积分的概念}

\subsection{复变函数积分的定义}

\begin{frame}{有向曲线}
	\onslide<+->
	设 $C$ 是平面上一条光滑或逐段光滑的连续曲线,
	\onslide<+->
	也就是说它的参数方程 $z=z(t),a\le t\le b$ 除去有限个点之外都有非零导数.
	\onslide<+->
	这里 $z'(t)=x'(t)+\ii y'(t)$.

	\onslide<+->
	固定它的一个方向, 称为\emph{正方向}, 则我们得到一条\emph{有向曲线}.
	\onslide<+->
	和这条曲线方向相反的记作 $C^-$, 它的方向被称为该曲线\emph{负方向}.

	\onslide<+->
	对于闭路, 它的\alert{正方向总是指逆时针方向}, 负方向总是指顺时针方向.
	\onslide<+->
	以后我们不加说明的话\alert{默认是正方向}.

	\onslide<2->
	\begin{center}
		\begin{tikzpicture}
			\draw[cstaxis](-3.5,0)--(3.5,0);
			\draw[cstaxis](0,-0.5)--(0,2.5);
			\begin{scope}[xshift=18mm,yshift=11mm,second,cstdot,cstcurve,smooth]
				\coordinate [label=left:{$A=z(a)$}] (A) at ({1.3*cos(-35)}, {1.3*sin(-35)});
				\coordinate [label=below:{$B=z(b)$}] (B) at ({1.3*cos(125)}, {1.3*sin(125)});
				\draw[main,domain=-35:125] plot ({1.3*cos(\x)}, {1.3*sin(\x)});
				\draw[main,domain=40:45,cstwra,visible on=<4->] plot ({1.3*cos(\x)}, {1.3*sin(\x)});
				\fill (A) circle;
				\fill (B) circle;
			\end{scope}
			\begin{scope}[xshift=-18mm,yshift=13mm,cstcurve,main,smooth,cstwla,visible on=<6->]
				\draw[domain=-65:30] plot ({-cos(\x)}, {.8*sin(\x)});
				\draw[domain=25:120] plot ({-cos(\x)}, {.8*sin(\x)});
				\draw[domain=115:210] plot ({-cos(\x)}, {.8*sin(\x)});
				\draw[domain=205:300] plot ({-cos(\x)}, {.8*sin(\x)});
			\end{scope}
		\end{tikzpicture}
	\end{center}
\end{frame}


\begin{frame}{复变函数积分: 线积分定义}
	\onslide<+->
	所谓的复变函数积分, 本质上仍然是第二类曲线积分.
	\onslide<+->
	设复变函数
	\[
		w=f(z)=u(x,y)+\ii v(x,y)
	\]
	定义在区域 $D$ 内, 有向曲线 $C$ 包含在 $D$ 中.
	\onslide<+->
	形式地展开
	\[
		f(z)\d z=(u+\ii v)(\d x+\ii\d y)=(u\d x-v\d y)+\ii(u\d y+v\d x).
	\]
	\bigdel
	\onslide<+->
	\begin{definition}
		若下述右侧两个线积分均存在, 则定义
	\[
			\int_C f(z)\d z=\int_C(u\d x-v\d y)+\ii\int_C(v\d x+u\d y)
	\]
		为 \emph{$f(z)$ 沿曲线 $C$ 的积分}.
	\end{definition}
\end{frame}


\begin{frame}{复变函数积分: 黎曼积分定义}
	\onslide<+->
	当然, 我们也可以像线积分那样通过分割来定义.
	\onslide<+->
	在曲线 $C$ 上依次选择分点 $z_0=A,z_1,\dots,z_{n-1},z_n=B$.
	\onslide<+->
	然后在每一段弧上任取 $\zeta_k\in\warc{z_{k-1}z_k}$ 并作和式
	\[
		S_n=\sum_{k=1}^n f(\zeta_k)\delt z_k,\quad \delt z_k=z_k-z_{k-1}.
	\]
	\onslide<+->
	然后称 $n\to\infty$, 分割的最大弧长 $\ra 0$ 时 $S_n$ 的极限为复变函数积分.
	\onslide<+->
	这二者是等价的.

	\onslide<2->
	\begin{center}
		\begin{tikzpicture}
			\draw[cstcurve,third,smooth,domain=0:360] plot ({0.015*\x},{0.6*sin(\x)});
			\draw[cstcurve,third,smooth,domain=195:200,cstra] plot ({0.015*\x},{0.6*sin(\x)});
			\begin{scope}[cstdot,third]
				\coordinate [label=left:{$A$}] (A);
				\coordinate [label=right:{$B$}] (B) at ({0.015*360},0) circle;
				\fill (A) circle;
				\fill (B) circle;
			\end{scope}
			\begin{scope}[cstdot,main,visible on=<2->]
				\coordinate [label=above:{$z_1$}] (z1) at ({0.015*64},{0.6*sin(64)});
				\coordinate [label=above:{$z_2$}] (z2) at ({0.015*128},{0.6*sin(128)});
				\coordinate [label=above:{$z_{n-2}$}] (zn2) at ({0.015*232},{0.6*sin(232)});
				\coordinate [label=above:{$z_{n-1}$}] (zn1) at ({0.015*296},{0.6*sin(296)});
				\coordinate [label=above:{$\ddots$}] (ddots) at ($(z1)!.5!(zn2)$);
				\fill (z1) circle;
				\fill (z2) circle;
				\fill (zn2) circle;
				\fill (zn1) circle;
			\end{scope}
			\begin{scope}[cstdot,second,visible on=<3->]
				\coordinate [label=below:{$\zeta_1$}] (zeta1) at ({0.015*32},{0.6*sin(32)});
				\coordinate [label=below:{$\zeta_2$}] (zeta2) at ({0.015*96},{0.6*sin(96)}) circle;
				\coordinate [label=below:{$\zeta_3$}] (zeta3) at ({0.015*160},{0.6*sin(160)}) circle;
				\coordinate [label=below:{$\zeta_{n-1}$}] (zetan1) at ({0.015*264},{0.6*sin(264)}) circle;
				\coordinate [label=below:{$\zeta_n$}] (zetan) at ({0.015*328},{0.6*sin(328)}) circle;
				\fill (zeta1) circle;
				\fill (zeta2) circle;
				\fill (zeta3) circle;
				\fill (zetan1) circle;
				\fill (zetan) circle;
			\end{scope}
		\end{tikzpicture}
	\end{center}
\end{frame}


\begin{frame}{复变函数积分的存在性}
	\onslide<+->
	若 $C$ 是闭路, 则该积分记为 \alert{$\doint_Cf(z)\d z$}.
	\onslide<+->
	此时该积分不依赖端点的选取.

	\onslide<+->
	若 $C$ 是实轴上的区间 $[a,b]$ 且 $f(z)=u(x)$, 
	\onslide<+->
	则
	\[
		\int_Cf(z)\d z=\int_a^bf(z)\d z=\int_a^b u(x)\d x
	\]
	就是黎曼积分.

	\onslide<+->
	根据线积分的存在性条件可知:
	\onslide<+->
	\begin{theorem}
		若 $f(z)$ 在 $D$ 内连续, $C$ 是光滑曲线, 则 $\dint_Cf(z)\d z$ 总存在.
	\end{theorem}
\end{frame}


\subsection{参变量法计算复变函数积分}

\begin{frame}{复变函数积分的计算法}
	\onslide<+->
	线积分中诸如变量替换等技巧可以照搬过来使用.
	\onslide<+->
	设
	\[
		C:z(t)=x(t)+\ii y(t),\quad a\le t\le b
	\]
	是一条光滑有向曲线, 且正方向为 $t$ 增加的方向,
	\onslide<+->
	则 $\d z=z'(t)\d t=\bigl(x'(t)+y'(t)\bigr)\d t$.
	\onslide<+->
	\begin{theorem*}[][积分计算方法I: 参变量法]
		\[
			\int_Cf(z)\d z=\int_a^b f\bigl(z(t)\bigr)z'(t)\d t.
		\]
	\end{theorem*}
	\onslide<+->
	若 $C$ 的正方向是从 $z(b)$ 到 $z(a)$, 则需要交换右侧积分的上下限.

	\onslide<+->
	若 $C$ 是逐段光滑的, 则相应的积分就是各段的积分之和.
	\onslide<+->
	以后我们\alert{只考虑逐段光滑曲线上的连续函数的积分}.
\end{frame}


\begin{frame}{典型例题: 计算复变函数沿曲线的积分}
	\onslide<+->
	\begin{example}[nearnext]
		求 $\dint_Cz\d z$, 其中 $C$ 是从原点到点 $3+4\ii$ 的直线段.
	\end{example}
	\onslide<+->
	\begin{solution}[nearprev,sidepic,righthand width=113pt]
		由于 $z=(3+4\ii)t,0\le t\le 1$,
		\onslide<+->{%
		因此
		\begin{align*}
			\int_Cz\d z&
			=\int_0^1(3+4\ii)t\cdot(3+4\ii)\d t
			\onslide<+->{=(3+4\ii)^2\int_0^1t\d t}\\&
			\onslide<+->{=\half (3+4\ii)^2=-\frac72+12\ii.}
		\end{align*}
		}\bigdel
		\tcblower
		\begin{tikzpicture}
			\coordinate (O) at (0,0);
			\draw[cstaxis](O)--(3,0);
			\draw[cstaxis](O)--(0,2.5);
			\coordinate (A) at (1.5,2);
			\draw[cstcurve,main,cstwra](O)--(A);
			\draw (A) node[below right,main,align=center] {$z=(3+4\ii)t$\\$0\le t\le 1$};
		\end{tikzpicture}
	\end{solution}
\end{frame}


\begin{frame}{典型例题: 计算复变函数沿曲线的积分}
	\onslide<+->
	\begin{example}[nearnext]
		求 $\dint_Cz\d z$, 其中 $C$ 是抛物线 $y=\dfrac49x^2$ 上从原点到点 $3+4\ii$ 的曲线段.
	\end{example}
	\onslide<+->
	\begin{solution}[nearprev,sidepic,righthand width=110pt]
		由于 $z=t+\dfrac49\ii t^2,0\le t\le 3$,
		\onslide<+->{%
			因此
			\begin{align*}
				\int_Cz\d z&=\int_0^3\biggl(t+\frac{4}9\ii t^2\biggr)\cdot\biggl(1+\frac89\ii t\biggr)\d t\\
				&\onslide<+->{=\int_0^3\biggl(t+\frac43\ii t^2-\frac{32}{81}t^3\biggr)\d t}\\
				&\onslide<+->{=\biggl(\half t^2+\frac49\ii t^3-\frac8{81}t^4\biggr)\Big|_0^3}
				\onslide<+->{=-\frac72+12\ii.}
			\end{align*}
		}\bigdel
		\tcblower
		\begin{tikzpicture}
			\draw[cstaxis](O)--(3,0);
			\draw[cstaxis](O)--(0,2.5);
			\draw[cstcurve,main,domain=0:1.5,cstwra] plot({\x},{8*\x*\x/9});
			\draw (A) node[right,main,align=center] {$z=t+\dfrac49\ii t^2$\\[1mm]$0\le t\le 3$};
		\end{tikzpicture}
	\end{solution}
\end{frame}


\begin{frame}{典型例题: 计算复变函数沿曲线的积分}
	\onslide<+->
	\begin{example}[nearnext]
		求 $\dint_C\Re z\d z$, 其中 $C$ 是从原点到点 $1+\ii$ 的直线段.
	\end{example}
	\onslide<+->
	\begin{solution}[nearprev,sidepic,righthand width=122pt]
		由于 $z=(1+\ii)t,0\le t\le 1$,
		\onslide<+->{%
			因此 $\Re z=t$,
		}\onslide<+->{%
			\begin{align*}
				\int_C\Re z\d z&
				=\int_0^1t\cdot(1+\ii)\d t\\&
				\onslide<+->{=(1+\ii)\int_0^1t\d t}
				\onslide<+->{=\frac{1+\ii}2.}
			\end{align*}
		}\bigdel
		\tcblower
		\begin{tikzpicture}
			\draw[cstaxis](O)--(3,0);
			\draw[cstaxis](O)--(0,2);
			\coordinate (B) at (2,2);
			\draw[cstcurve,main,cstwra](O)--(B);
			\draw (B) node[below right,main,align=center] {$z=(1+\ii)t$\\$0\le t\le 1$};
		\end{tikzpicture}
	\end{solution}
\end{frame}


\begin{frame}{典型例题: 计算复变函数沿曲线的积分}
	\onslide<+->
	\begin{example}[nearnext]
		求 $\dint_C\Re z\d z$, 其中 $C$ 是从原点到点 $\ii$ 再到 $1+\ii$ 的折线段.
	\end{example}
	\onslide<+->
	\begin{solution}[nearprev,sidepic,righthand width=146pt]
		第一段 $z=\ii t$, $0\le t\le 1$, $\Re z=0$,
		\onslide<+->{%
			第二段 $z=t+\ii$, $0\le t\le 1$, $\Re z=t$.
		}\onslide<+->{%
			因此
			\[
				\int_C\Re z\d z=\int_0^1 t\d t=\frac12.
			\]
		}\bigdel
		\tcblower
		\begin{tikzpicture}
			\draw[cstaxis](O)--(2.5,0);
			\draw[cstaxis](O)--(0,2);
			\coordinate (C) at (0,1.5);
			\coordinate (D) at (1.5,1.5);
			\draw[cstcurve,main,cstwra](O)--(C);
			\draw[cstcurve,second,cstwra,visible on=<3->](C)--(D);
			\draw
				(C) node[below left,align=center,main] {$z=\ii t$\\$0\le t\le 1$}
				(D) node[right,align=center,second,visible on=<3->] {$z=t+\ii$\\$0\le t\le 1$};
		\end{tikzpicture}
	\end{solution}
\end{frame}


\begin{frame}{典型例题: 计算复变函数沿曲线的积分}
	\onslide<+->
	可以看出, 即便起点和终点相同, 沿不同路径 $f(z)=\Re z$ 的积分也可能不同.
	\onslide<+->
	而 $f(z)=z$ 的积分则只和起点和终点位置有关, 与路径无关.
	\onslide<+->
	原因在于 $f(z)=z$ 是处处解析的, 我们会在下一节解释为何如此.

	\onslide<+->
	\begin{exercise}[sidepic,righthand width=96pt]
		求 $\dint_C\Im z\d z=$\fillblankframe[3cm][2mm]{$-\dfrac12+\dfrac\ii2$}, 其中 $C$ 是从原点沿 $y=x$ 到点 $1+\ii$ 再到 $\ii$ 的折线段.
		\tcblower
		\begin{center}
			\begin{tikzpicture}
				\draw[cstaxis](O)--(2,0);
				\draw[cstaxis](O)--(0,2);
				\draw[cstcurve,cstwra,main](O)--(D);
				\draw[cstcurve,cstwra,second](D)--(C);
			\end{tikzpicture}
		\end{center}
	\end{exercise}
\end{frame}


\begin{frame}{例题: 计算复变函数沿圆周的积分}
	\onslide<+->
	\begin{example}[nearnext]
		求 $\doint_{\abs{z-z_0}=r}\frac{\d z}{(z-z_0)^{n+1}}$, 其中 $n$ 为整数.
	\end{example}
	\onslide<+->
	\begin{solution}[nearprev]
		$C: \abs{z-z_0}=r$ 的参数方程为 $z=z_0+r\ee^{\ii\theta},0\le \theta\le 2\pi$.
		\onslide<+->{%
			于是 $\d z=\ii r\ee^{\ii\theta}\d \theta$.
		}\onslide<+->{%
			\begin{align*}
				\alertn{\oint_C\frac{\d z}{(z-z_0)^{n+1}}}
				&=\int_0^{2\pi}\ii(r\ee^{\ii\theta})^{-n}\d\theta
				\onslide<+->{=\ii r^{-n}\int_0^{2\pi}\ee^{-\ii n\theta}\d\theta}\\
				&\onslide<+->{=\ii r^{-n}\int_0^{2\pi}\bigl(\cos(n\theta)+\ii\sin(n\theta)\bigr)\d\theta}
				\onslide<+->{=\begin{cases}
					\alertn{2\pi\ii,}&\alertn{\text{\alert{若}}\ n=0;}\\
					\alertn{0,}&\alertn{\text{\alert{若}}\ n\neq0.}
				\end{cases}}
			\end{align*}
		}
	\end{solution}
	\onslide<+->
	这个积分以后经常用到, 它的特点是积分值与圆周的圆心和半径都无关.
\end{frame}


\begin{frame}{积分的性质}
	\onslide<+->
	\begin{theorem}[][线性性质]
		\begin{enumerate}
			\item $\dint_Cf(z)\d z=-\dint_{C^-}f(z)\d z$.
			\item $\dint_Ckf(z)\d z=k\dint_Cf(z)\d z$.
			\item $\dint_C[f(z)\pm g(z)]\d z
			=\dint_Cf(z)\d z\pm\dint_Cg(z)\d z$.
		\end{enumerate}
	\end{theorem}
\end{frame}


\subsection{长大不等式和大小圆弧引理}


\begin{frame}{长大不等式\noexer}
	\onslide<+->
	\begin{theorem*}[nearnext][长大不等式]
		设有向曲线 $C$ 的长度为 $L$, $f(z)$ 在 $C$ 上满足 $\abs{f(z)}\le M$, 则
		\[
			\biggabs{\int_C f(z)\d z}\le\int_C \abs{f(z)}\d s\le ML.
		\]
	\end{theorem*}
	\onslide<+->
	\begin{proof}[nearprev]
		对
			$\displaystyle
				\biggabs{\sum_{k=1}^n f(\zeta_k)\delt z_k}
				\le\sum_{k=1}^n\abs{f(\zeta_k)\delt z_k}
				\le\sum_{k=1}^n\abs{f(\zeta_k)}\delt s_k
				\le M\sum_{k=1}^n\delt s_k
			$
		\onslide<+->{%
			取极限即可.\qedhere
		}
	\end{proof}
	\onslide<+->
	长大不等式常常用于证明等式: 估算一个积分和一个具体的数值之差不超过任意给定的 $\varepsilon$, 从而得到二者相等.

	\onslide<+->
	注意到: 若被积函数 $f(z)$ 在 $C$ 上的点都连续, 那么 $\abs{f(z)}$ 是 $C$ 的参变量 $t\in[a,b]$ 的连续函数, 从而有界, 即存在 $M$ 使得 $\abs{f(z)}\le M,\forall z\in C$.
\end{frame}


\begin{frame}{小圆弧引理\noexer}
	\onslide<+->
	\begin{theorem*}[nearnext][小圆弧引理]
		设函数 $f(z)$ 满足 $\liml_{z\ra a}(z-a)f(z)=k$.
		那么对于闭路
		\[
			C_r: z=a+r\ee^{\ii \theta},\quad \theta_1\le\theta\le\theta_2,
		\]
		有
		\[
			\lim_{r\ra0}\int_{C_r}f(z)\d z
			=\ii k(\theta_2-\theta_1).
		\]
	\end{theorem*}
\end{frame}


\begin{frame}{小圆弧引理的证明\noexer}
	\onslide<+->
	\begin{proof}[nearprev]
		和前面的例题类似, 
		\[
			\int_{C_r} \frac1{z-a}\d z
			=\int_{\theta_1}^{\theta_2} \frac1{r\ee^{\ii\theta}}\cdot \ii r\ee^{\ii\theta}\d\theta
			=\ii(\theta_2-\theta_1).
		\]
		\onslide<+->{%
			对任意 $\varepsilon>0$, 存在 $\delt>0$ 使得当 $\abs{z-a}<\delt$ 时, $\bigabs{(z-a)f(z)-k}\le\varepsilon$.
		}\onslide<+->{%
			当 $0<r<\delt$ 时,
			\begin{align*}
					&\biggabs{\int_{C_r}f(z)\d z-\ii k(\theta_2-\theta_1)}
				=\biggabs{\int_{C_r}\Bigl(f(z)-\frac k{z-a}\Bigr)\d z}\\
				={}&\biggabs{\int_{C_r}\frac{(z-a)f(z)-k}{z-a}\d z}
				\le \frac{\varepsilon}r\cdot 2\pi r
				=2\pi\varepsilon.
			\end{align*}
			于是命题得证.
		}
	\end{proof}
\end{frame}


\begin{frame}{小圆弧引理\noexer}
	\onslide<+->
	特别地, 若 $C_r:\abs{z-a}=r$, 则上述极限为 $2k\pi \ii$.

	\onslide<+->
	类似地, 若 $\liml_{z\ra \infty} zf(z)=k$, 则有大圆弧引理.
	\begin{theorem*}[][大圆弧引理]
		设函数 $f(z)$ 满足 $\liml_{z\ra\infty}zf(z)=k$.
		那么对于闭路
		\[
			C_R: z=R\ee^{\ii \theta},\quad \theta_1\le\theta\le\theta_2,
		\]
		有
		\[
			\lim_{R\ra+\infty}\int_{C_R}f(z)\d z=\ii k(\theta_2-\theta_1).
		\]
	\end{theorem*}
	\onslide<+->
	上述结论中实际上只需要 $f(z)$ 在 $\theta_1\le \Arg z\le \theta_2$ 范围内的极限满足相应条件即可.
	\onslide<+->
	此外, 实际应用中遇到的常常是 $k=0$ 的情形.
\end{frame}
