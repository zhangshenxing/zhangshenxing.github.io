\section{泰勒级数}

\subsection{泰勒展开的形式与性质}

\begin{frame}{实泰勒级数的特点}
	\onslide<+->
	我们知道, 幂级数在它的收敛域内的和函数是一个解析函数.
	\onslide<+->
	反过来, 解析函数是不是也一定可以在一点展开成幂级数呢? 也就是说是否存在\emph{泰勒级数}展开?

	\onslide<+->
	在高等数学中我们知道, 一个函数即使在一点附近无限次可导, 它的泰勒级数也未必收敛到原函数.
	\onslide<+->
	例如
	\[f(x)=\begin{cases}
	\ee^{-x^{-2}},&x\neq 0,\\
	0,&x=0.\end{cases}
	\]
	\onslide<+->
	它处处可导, 但是它在 $0$ 处的各阶导数都是 $0$.
	\onslide<+->
	因此它的泰勒级数是 $0$, 余项恒为 $f(x)$.
	\onslide<+->
	除 $0$ 外它的泰勒级数均不收敛到原函数.
\end{frame}


\begin{frame}{实泰勒级数的特点}
	\onslide<+->
	而即使是泰勒级数能收敛到原函数的情形, 它成立的范围也很难从函数本身读出.
	\onslide<+->
	例如
	\[
		\dfrac1{1+x}=1-x+x^2-x^3+\cdots,\quad\abs{x}<1.
	\]
	\onslide<+->
	这可以从 $x=-1$ 是奇点看出.
	\onslide<+->
	而
	\[
		\dfrac1{1+x^2}=1-x^2+x^4-x^6+\cdots,\quad\abs{x}<1
	\]
	却并没有奇点.
	\onslide<+->
	为什么它的麦克劳林级数成立的开区间也是 $(-1,1)$?
	\onslide<+->
	这个问题在本节可以得到回答.
\end{frame}


\begin{frame}{泰勒展开的形式\noexer}
	\onslide<+->
	设函数 $f(z)$ 在区域 $D$ 解析, $z_0\in D$.
	\onslide<+->
	设 $\abs{z-z_0}$ 小于 $z_0$ 到 $D$ 边界的距离 $d$,
	则存在 $\abs{z-z_0}<r<d$.
	\onslide<+->
	设 $K:\abs{\zeta-z_0}=r$, 则 $K$ 和它的内部包含在 $D$ 中.
	\onslide<+->
	由于 $\biggabs{\dfrac{z-z_0}{\zeta-z_0}}<1$, 因此
	\[
		\frac1{\zeta-z}
		=\frac1{\zeta-z_0}\cdot\frac1{1-\dfrac{z-z_0}{\zeta-z_0}}
		=\sumf0\frac{(z-z_0)^n}{(\zeta-z_0)^{n+1}}.
	\]
	\onslide<1->
	\begin{center}
		\begin{tikzpicture}
			\filldraw[cstcurve,main,smooth,cstfill] plot coordinates {(-2.25,0) (-1.5,-0.75) (0,-1.5) (1.05,-1.5) (1.35,0) (0,1.2) (-1.5,1.2) (-2.25,0)};
			\draw[cstdash,third,visible on=<2->] (0,0) circle (1);
			\draw[cstcurve,second,visible on=<3->] (0,0) circle (0.8);
			\fill[cstdot,second] (0,0) circle;
			\fill[cstdot,third,visible on=<2->] (0.4,0.4) circle;
			\fill[cstdot,visible on=<3->] (0.6,-0.5) circle;
			\draw[cstcurve,cstra,second,visible on=<3->] (0,0)--(-0.48,-0.64);
			\draw
				(-0.25,0) node[second] {$z_0$}
				(0.2,0.4) node[third,visible on=<2->] {$z$}
				(0,-0.5) node[second,visible on=<3->] {$r$}
				(0.4,-0.3) node[main,visible on=<3->] {$\zeta$};
		\end{tikzpicture}
	\end{center}
\end{frame}


\begin{frame}{泰勒展开的形式\noexer}
	\onslide<+->
	故
	\begin{align*}
		f(z)&=\frac1{2\pi\ii}\oint_K \frac{f(\zeta)}{\zeta-z}\d\zeta
		\visible<+->{=\frac1{2\pi\ii}\oint_K f(\zeta)\sumf0\frac{(z-z_0)^n}{(\zeta-z_0)^{n+1}}\d\zeta}\\
		&\visible<+->{=
		\sum_{n=0}^{N-1}\biggl(\frac1{2\pi\ii}\oint_K\frac{f(\zeta)\d\zeta}{(\zeta-z_0)^{n+1}}\biggr)(z-z_0)^n+R_N(z),}\\
		&\visible<+->{=
		\sum_{n=0}^{N-1}\frac{f^{(n)}(z_0)}{n!}(z-z_0)^n+R_N(z),}
	\end{align*}
	\onslide<+->
	其中
	\[
		R_N(z)=\frac1{2\pi\ii}\oint_Kf(\zeta)\biggl(\sum_{n=N}^\infty\frac{(z-z_0)^n}{(\zeta-z_0)^{n+1}}\biggr)\d\zeta
		=\frac1{2\pi\ii}\oint_K\frac{f(\zeta)}{\zeta-z}\cdot\Bigl(\frac{z-z_0}{\zeta-z_0}\Bigr)^N\d\zeta.
	\]
\end{frame}


\begin{frame}{泰勒展开的形式}
	\onslide<+->
	由于 $f(\zeta)$ 在 $D\supseteq K$ 上解析, 从而在 $K$ 上连续且有界.
	\onslide<+->
	设 $\abs{f(\zeta)}\le M,\zeta\in K$,
	\onslide<+->
	那么
	\begin{align*}
		\abs{R_N(z)}&\le\frac 1{2\pi}\oint_K\biggabs{\frac{f(\zeta)}{\zeta-z}\cdot\Bigl(\frac{z-z_0}{\zeta-z_0}\Bigr)^N}\d s\\
		&\visible<+->{\le\frac 1{2\pi}\cdot \frac M{r-\abs{z-z_0}}\cdot\biggabs{\frac{z-z_0}{\zeta-z_0}}^N\cdot 2\pi r\to 0\quad (N\to\infty).}
	\end{align*}
	\onslide<+->
	故
	\[
		\alertm{f(z)=\sumf0\frac{f^{(n)}(z_0)}{n!}(z-z_0)^n},\quad \abs{z-z_0}<d.
	\]
\end{frame}


\begin{frame}{泰勒展开的成立范围}
	\onslide<+->
	由于幂级数在收敛半径内的和函数是解析的, 因此上述等式成立的圆域不包含奇点.
	\onslide<+->
	故解析函数在 $z_0$ 处\alert{泰勒展开成立的最大圆域半径是 $\alertm{z_0}$ 到最近奇点的距离}.
	\onslide<+->
	需要注意的是, 泰勒级数的收敛半径是有可能比这个半径更大的:
	\[f(z)=\begin{cases}
	\ee^z,&z\neq 1;\\ 0,&z=1,
	\end{cases}\qquad f(z)=\sumf0 \dfrac{z^n}{n!},\quad \abs{z}<1.
	\]
	\onslide<+->
	\[f(z)=\ln(z-1-\ii ),\qquad f(z)=-\frac1{1+\ii}\sumf0\frac1{n(1+\ii)^n}z^n,\quad \abs{z}<1.
	\]
	\onslide<+->
	若并非这两种情形(奇点``可去''), 则收敛半径的确就是前述距离.

	\onslide<+->
	对于
	\[
		f(z)=\begin{cases}
		\ee^{-z^{-2}},&z\neq 0,\\
		0,&z=0.\end{cases}
	\]
	\onslide<+->
	$\liml_{y\to 0}f(\ii y)=\infty$, 因此 $f(z)$ 在 $0$ 处不连续, 无法在 $0$ 处进行复的泰勒展开.
\end{frame}


\subsection{泰勒展开的计算方法}
\begin{frame}{幂级数展开的唯一性}
	\onslide<+->
	对于 $f(z)=\dfrac1{1+z^2}$,
	\onslide<+->
	它的奇点为 $\pm \ii$, 所以它的麦克劳林展开成立的半径是 $1$.
	\onslide<+->
	这就解释了为什么函数 $f(x)=\dfrac1{1+x^2}$ 的麦克劳林展开成立的开区间是 $(-1,1)$.

	\onslide<+->
	若 $f(z)$ 在 $z_0$ 附近展开为 $\sumf0 c_n(z-z_0)^n$,
	\onslide<+->
	则由幂级数的逐项求导性质可知
	\[f^{(n)}(z_0)=\sum_{k=n}^\infty c_k k(k-1)\cdots(k-n+1)(z-z_0)^{k-n}\Big|_{z=z_0}=n!c_n.
	\]
	\onslide<+->
	所以\alert{解析函数的幂级数展开是唯一的}.
	\onslide<+->
	由此, 解析函数的泰勒展开不仅可以\emph{直接求出各阶导数得到}, 也可以\emph{利用幂级数的运算法则得到}.

	\onslide<+->
	解析函数的泰勒展开还说明了幂级数的和函数无论怎样扩充定义域, 它在\alert{收敛圆周上一定有奇点}.
	\onslide<+->
	否则它就可以在一个半径更大的圆域上泰勒展开成该幂级数.
\end{frame}


\begin{frame}{典型例题: 泰勒展开的计算}
	\onslide<+->
	\begin{example}
		由于 $(\ee^z)^{(n)}(0)=\ee^z|_{z=0}=1$,
		\onslide<+->{%
			因此
			\[
				\emphn{\ee^z=1+z+\frac{z^2}{2!}+\frac{z^3}{3!}+\cdots=\sumf0\frac{z^n}{n!},\quad\forall z.}
			\]
		}\bigdel
	\end{example}

	\onslide<+->
	\begin{example}
		由于 $\displaystyle(\cos z)^{(n)}=\cos\Bigl(z+\dfrac{n\pi}2\Bigr)$,
		\onslide<+->{%
			\[
				(\cos z)^{(2n+1)}(0)=0,\quad (\cos z)^{(2n)}(0)=(-1)^n,
			\]
		}\onslide<+->{%
			因此
			\[
				\emphn{\cos z=1-\frac{z^2}{2!}+\frac{z^4}{4!}-\frac{z^6}{6!}+\cdots=\sumf0(-1)^n\frac{z^{2n}}{(2n)!},\quad\forall z.}
			\]
		}\bigdel
	\end{example}
\end{frame}


\begin{frame}{典型例题: 泰勒展开的计算}
	\onslide<+->
	\begin{example}
		由 $\ee^z$ 的泰勒展开可得
		\begin{align*}
			\emphn{\sin z}&=\frac{\ee^{\ii z}-\ee^{-\ii z}}{2\ii}
			\visible<+->{=\sumf0\frac{(\ii z)^n-(-\ii z)^n}{2\ii\cdot n!}}\\
			&\visible<+->{\emphn{=z-\frac{z^3}{3!}+\frac{z^5}{5!}-\cdots}
			\emphn{=\sumf0(-1)^n\frac{z^{2n+1}}{(2n+1)!},\quad\forall z.}}
		\end{align*}
		\onslide<+->
		这里, 因为 $\sin z$ 是奇函数, 所以它的麦克劳林展开只有奇数幂次项, 没有偶数幂次项.
	\end{example}
\end{frame}


\begin{frame}{典型例题: 泰勒展开的计算}
	\onslide<+->
	\begin{example}[nearnext]
		求对数函数的主值 $\ln(1+z)$ 的麦克劳林展开.
	\end{example}
	\onslide<+->
	\begin{solution}[nearprev]
		由于 $\ln(1+z)$ 在去掉射线 $z=x\le-1$ 的区域内解析,
		\onslide<+->{%
			因此它在 $\abs{z}<1$ 内解析,
		}\onslide<+->{%
		且
		\[
			\bigl(\ln(1+z)\bigr)'
			=\frac1{1+z}=\sumf0(-1)^nz^n,\quad\abs{z}<1.
		\]
		}\onslide<+->{%
			逐项积分得到
			\begin{align*}
				\ln(1+z)&=\int_0^z\frac1{1+\zeta}\d\zeta
				\visible<+->{=\int_0^z\sumf0(-1)^n\zeta^n\d\zeta}\\
				&\visible<+->{=\sumf0\frac{(-1)^nz^{n+1}}{n+1}}
				\visible<+->{=\sumf1\frac{(-1)^{n+1}z^n}{n},\quad\abs{z}<1.}
			\end{align*}
		}\bigdel
	\end{solution}
\end{frame}


\begin{frame}{典型例题: 泰勒展开的计算}
	\onslide<+->
	\begin{example}
		本例中幂函数均取主值.
		\onslide<+->{%
			$f(z)=(1+z)^\alpha$ 在去掉射线 $z=x\le -1$ 的区域内解析.
		}\onslide<+->{%
			由于
			\begin{align*}
				f^{(n)}(0)&=\alpha(\alpha-1)\cdots(\alpha-n+1)(1+z)^{\alpha-n}\Big|_{z=0}\\
				&\visible<+->{=\alpha(\alpha-1)\cdots(\alpha-n+1).}
			\end{align*}
		}\onslide<+->{%
			因此
			\begin{align*}
				\emphn{(1+z)^\alpha}&\emphn{=1+\alpha z+\frac{\alpha(\alpha-1)}2z^2+\frac{\alpha(\alpha-1)(\alpha-2)}{3!}z^3+\cdots}\\
				&\emphn{=\sumf0\frac{\alpha(\alpha-1)\cdots(\alpha-n+1)}{n!}z^n,\quad \abs{z}<1.}
			\end{align*}
		}\bigdel
	\end{example}
\end{frame}

\begin{frame}{典型例题: 泰勒展开的计算}
	\onslide<+->
	当 $\alpha=n$ 是正整数时, 上述麦克劳林展开的 $>n$ 幂次项系数为零, 
	\onslide<+->
	从而
	\[
		(1+z)^n=\sum_{k=0}^n \mathrm{C}_n^k z^k,
	\]
	此即牛顿二项式展开.

	\onslide<+->
	\begin{example}[nearnext]
		将 $\dfrac1{(1+z)^2}$ 展开成 $z$ 的幂级数.
	\end{example}

	\onslide<+->
	\begin{solution}[nearprev]
		由幂函数展开可知当 $\abs{z}<1$ 时,
		\[
			(1+z)^{-2}=\sumf0 \frac{(-2)(-3)\cdots(-1-n)}{n!}z^n
			\visible<+->{=\sumf0 (-1)^n(n+1)z^n.}
		\]
		\bigdel
	\end{solution}
\end{frame}


\begin{frame}{典型例题: 泰勒展开的计算}
	\onslide<+->
	\begin{solution}[nearprev][另解]
		由于 $\dfrac1{(1+z)^2}$ 的奇点为 $z=-1$, 因此它在 $\abs{z}<1$ 内解析.
		\onslide<+->{%
			由于
			\[
				\frac1{1+z}=1-z+z^2-z^3+\cdots=\sumf0 (-1)^nz^n,
			\]
		}\onslide<+->{%
			因此
			\[
				\frac1{(1+z)^2}=-\Bigl(\frac1{1+z}\Bigr)'
				\visible<+->{=-\sumf1(-1)^n nz^{n-1}}
				\visible<+->{=\sumf0(-1)^n (n+1)z^n,\quad \abs{z}<1.}
			\]
		}\bigdel
	\end{solution}
	\onslide<+->
	一般地, 我们有
	\[
		\frac1{(\lambda-z)^k}
		=\sumf0 \frac{(n+k-1)\cdots(n+2)(n+1)}{(k-1)!}\lambda^{-(n+k)}z^n,\abs{z}<\abs{\lambda}.
	\]
\end{frame}


\begin{frame}{典型例题: 泰勒展开的计算}
	\onslide<+->
	\begin{example}[nearnext]
		求 $\dfrac1{3z-2}$ 的麦克劳林展开.
	\end{example}
	\onslide<+->
	\begin{solution}[nearprev]
		由于 $\dfrac1{3z-2}$ 的奇点为 $z=\dfrac23$, 因此它在 $\abs{z}<\dfrac23$ 内解析.
		\onslide<+->{此时
		\begin{align*}
			\frac1{3z-2}&=-\half\cdot\frac1{1-\dfrac{3z}2}
				\visible<+->{=-\half\sumf0\Bigl(\frac{3z}2\Bigr)^n}\\
			&\visible<+->{=-\sumf0\frac{3^n}{2^{n+1}}z^n,\quad\abs{z}<\frac23.}
		\end{align*}}
		\bigdel
	\end{solution}
\end{frame}


\begin{frame}{典型例题: 泰勒展开的计算}
	\onslide<+->
	\begin{exercise}
		求 $\dfrac1{1-3z+2z^2}$ 的麦克劳林展开.
	\end{exercise}

	\onslide<+->
	\begin{answer}
	\[
		\frac1{1-3z+2z^2}=\frac{2}{1-2z}-\frac1{1-z}
		=\sumf0(2^{n+1}-1)z^n,\quad \abs{z}<\half .
	\]
	\end{answer}
\end{frame}


