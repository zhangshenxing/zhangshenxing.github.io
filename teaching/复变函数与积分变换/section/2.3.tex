\section{初等函数}

\subsection{指数函数}

\begin{frame}{指数函数}
	\onslide<+->
	我们将实变函数中的初等函数推广到复变函数.
	\onslide<+->
	多项式函数和有理函数的解析性质已经介绍过, 这里不再重复.
	\onslide<+->
	现在我们来定义指数函数.

	\onslide<+->
	指数函数有多种等价的定义方式:
	\begin{enumerate}
		\item $\exp z=\ee^x(\cos y+\ii\sin y)$ (欧拉恒等式);
		\item $\exp z=\liml_{n\to\infty}\Bigl(1+\dfrac zn\Bigr)^n$ (极限定义);
		\item $\exp z=1+z+\dfrac{z^2}{2!}+\dfrac{z^3}{3!}+\cdots
		=\liml_{n\to\infty}\sum\limits_{k=0}^n\dfrac{z^k}{k!}$ (级数定义);
		\item $\exp z$ 是唯一的一个处处解析的函数, 使得当 $z=x\in\BR$ 时, $\exp z=\ee^x$ ($\ee^x$ 的解析延拓).
	\end{enumerate}
\end{frame}


\begin{frame}{指数函数与欧拉恒等式}
	\onslide<+->
	有些人会从 $\ee^x,\cos x,\sin x$ 的泰勒展开
	\begin{align*}
		\ee^x&=1+x+\frac{x^2}{2!}+\frac{x^3}{3!}+\cdots\\
		\cos x&=1-\frac{x^2}{2!}+\frac{x^4}{4!}+\cdots\\
		\sin x&=x-\frac{x^3}{3!}+\frac{x^5}{5!}\cdots
	\end{align*}
	形式地带入得到欧拉恒等式 $\ee^{\ii x}=\cos x+\ii\sin x$.
	\onslide<+->
	事实上我们可以把它当做复指数函数的定义, 而不是欧拉恒等式的证明.
	\onslide<+->
	我们将在第四章说明\enumnum1、\enumnum3和\enumnum4是等价的.
\end{frame}



\begin{frame}{指数函数的定义}
	\onslide<+->
	我们来证明\enumnum1和\enumnum2等价.
	\onslide<+->
	\begin{align*}
		\lim_{n\to\infty}\Bigabs{1+\frac zn}^n
		&=\lim_{n\to\infty}\Bigl(1+\frac{2x}n+\frac{x^2+y^2}{n^2}\Bigr)^{\frac n2}\quad
		\visible<+->{(1^\infty\ \text{型不定式})}\\
		&\visible<+->{=\exp\left[\lim_{n\to\infty}\frac n2
		\Bigl(\frac{2x}n+\frac{x^2+y^2}{n^2}\Bigr)\right]=\ee^x.}
	\end{align*}
	\onslide<+->
	不妨设 $n>\abs{z}$, 这样 $1+\dfrac zn$ 落在右半平面,
	\onslide<+->
	\[
		\lim_{n\to\infty} n\arg{\Bigl(1+\frac zn\Bigr)}
		=\lim_{n\to\infty} n\arctan \frac y{n+x}
		\visible<+->{=\lim_{n\to\infty}\frac{ny}{n+x}=y.}
	\]
	\bigdel
	\onslide<+->
	故 $\exp z=\ee^x(\cos y+\ii\sin y)$.
\end{frame}


\begin{frame}{指数函数的性质}
	\onslide<+->
	\begin{definition*}[][指数函数]
	\[
		\exp z:=\ee^x(\cos y+\ii\sin y).
	\]
	\end{definition*}
	\onslide<+->
	为了方便, 我们也记 $\emphm{\ee^z=\exp z}$.
	\onslide<+->
	指数函数有如下性质:
	\begin{itemize}\bf
		\item $\exp z$ 处处解析, 且 $(\exp z)'=\exp z$.
		\item $\exp z\neq 0$.
		\item $\exp(z_1+z_2)=\exp z_1\cdot \exp z_2$.
		\item $\exp(z+2k\pi\ii)=\exp z$, 即 $\exp z$ 周期为 $2\pi\ii$.
		\item $\exp z_1=\exp z_2$ 当且仅当 $z_1=z_2+2k\pi\ii,k\in\BZ$.
		\item 指数函数将直线族 $\Re z=c$ 映为圆周族 $\abs{w}=\ee^c$, 将直线族 $\Im z=c$ 映为射线族 $\Arg w=c$.
	\end{itemize}
\end{frame}


\begin{frame}{指数函数的性质}
	\onslide<+->
	\begin{example}
		计算函数 $f(z)=\exp(z/6)$ 的周期.
	\end{example}

	\onslide<+->
	\begin{solution}
		设 $f(z_1)=f(z_2)$, 则 $\ee^{z_1/6}=\ee^{z_2/6}$.
		\onslide<+->{%
			因此存在 $k\in\BZ$ 使得
			\[
				\frac{z_1}6=\frac{z_2}6+2k\pi\ii,
			\]
		}\onslide<+->{%
			从而 $z_1-z_2=12k\pi\ii$.
		}\onslide<+->{%
			所以 $f(z)$ 的周期是 $12\pi\ii$.
		}
	\end{solution}

	\onslide<+->
	一般地, $\exp(az+b)$ 的周期是 $\dfrac{2\pi\ii}a$ (或写成 $-\dfrac{2\pi\ii}a$), $a\neq 0$.
\end{frame}


\subsection{对数函数}

\begin{frame}{对数函数}
	\onslide<+->
	对数函数 $\Ln z$ 定义为指数函数 $\exp z$ 的反函数.
	\onslide<+->
	为什么我们用大写的 $\Ln$ 呢? 
	\onslide<+->
	在复变函数中, 很多函数是多值函数.
	\onslide<+->
	为了便于研究, 我们会固定它的一个单值分支.
	\onslide<+->
	我们将多值的这个开头字母大写, 而对应的单值的则是开头字母小写.
	\onslide<+->
	例如 $\Arg z$ 和 $\arg z$.

	\onslide<+->
	设 $z\neq0,\ee^w=z=r\ee^{\ii\theta}=\ee^{\ln r+\ii\theta}$,
	\onslide<+->
	则
	\[w=\ln r+\ii\theta+2k\pi\ii,\quad k\in\BZ.
	\]
\end{frame}


\begin{frame}{对数函数及其主值}
	\onslide<+->
	\begin{definition*}{对数函数}
		\begin{enumerate}
			\item 定义\emph{对数函数}
			\[
				\Ln z=\ln\abs{z}+\ii\Arg z.
			\]
			它是一个多值函数.
			\item 定义\emph{对数函数主值}
			\[
				\ln z=\ln\abs{z}+\ii\arg z.
			\]
			\bigdel
		\end{enumerate}
	\end{definition*}

	\onslide<+->
	对于每一个整数 $k$, $\ln z+2k\pi\ii$ 都给出了 $\Ln z$ 的一个单值分支.
	\onslide<+->
	特别地, 当 $z=x>0$ 是正实数时, $\ln z$ 就是实变的对数函数.
\end{frame}


\begin{frame}{例题: 对数函数的计算}
	\onslide<+->
	\begin{example}
		求 $\Ln 2,\Ln(-1)$ 以及它们的主值.
	\end{example}

	\onslide<+->
	\begin{solution}
		\begin{enumerate}
			\item
			\[
				\Ln2=\ln2+2k\pi\ii, k\in\BZ,
			\]
			\onslide<+->{%
				主值为 $\ln 2$.
			}
			\item
			\[
				\Ln(-1)=\ln1+\ii\Arg(-1)=(2k+1)\pi\ii, k\in\BZ,
			\]
			\onslide<+->{%
				主值为 $\pi\ii$.
			}
		\end{enumerate}
	\end{solution}
\end{frame}


\begin{frame}{例题: 对数函数的计算}
	\beqskip{5pt}
	\onslide<+->
	\begin{example}
	求 $\Ln(-2+3\ii),\Ln(3-\sqrt3 i)$.
	\end{example}

	\onslide<+->
	\begin{solution}
		\begin{enumerate}
			\item
			\begin{align*}
				\Ln(-2+3\ii)&=\ln\abs{-2+3\ii}+\ii\Arg(-2+3\ii)\\
				&\visible<+->{=\frac 12\ln 13+\Bigl(-\arctan\frac 32+\pi+2k\pi\Bigr)\ii,\quad k\in\BZ.}
			\end{align*}
			\item
			\begin{align*}
				\Ln(3-\sqrt3\ii)&=\ln\abs{3+\sqrt 3\ii}+\ii\Arg(3-\sqrt 3\ii)\\
				&\visible<+->{=\ln 2\sqrt 3+\Bigl(-\frac\pi6+2k\pi\Bigr)\ii
				=\ln 2\sqrt 3+\Bigl(2k-\frac16\Bigr)\pi\ii,\quad k\in\BZ.}
			\end{align*}
		\end{enumerate}
		\vspace{-.5\baselineskip}
	\end{solution}
	\endgroup
\end{frame}


\begin{frame}{例题: 对数函数的计算}
	\onslide<+->
	\begin{example}
		解方程 $\ee^z-1-\sqrt 3\ii=0$.
	\end{example}

	\onslide<+->
	\begin{solution}
		由于 $1+\sqrt 3 i=2\ee^{\frac{\pi\ii}3}$,
		\onslide<+->{%
			因此
			\[
				z=\Ln(1+\sqrt 3\ii)=\ln 2+\Bigl(2k+\frac13\Bigr)\pi\ii,\quad k\in\BZ.
			\]
		}\bigdel
	\end{solution}

	\onslide<+->
	\begin{exercise}
		求 $\ln(-1-\sqrt3\ii)=$\fillblankframe[2cm][3mm]{$\ln 2-\dfrac{2\pi\ii}3$}.
	\end{exercise}
\end{frame}


\begin{frame}{对数函数的性质}
	\onslide<+->
	对数函数与其主值的关系是
	\[
		\emphn{\Ln z=\ln z+\Ln 1=\ln z+2k\pi\ii,\quad k\in\BZ}.
	\]

	\onslide<+->
	根据辐角以及辐角主值的相应等式, 我们有
	\[
		\Ln(z_1\cdot z_2)=\Ln z_1+\Ln z_2,\quad
		\Ln\frac{z_1}{z_2}=\Ln z_1-\Ln z_2,
	\]
	\[
		\Ln \sqrt[n]z=\dfrac1n\Ln z.
	\]
	\onslide<+->
	而当 $\abs{n}\ge 2$ 时, \alert{$\Ln z^n=n\Ln z$ 不成立}.
	\onslide<+->
	以上等式换成 $\ln z$ 均未必成立.
\end{frame}


\begin{frame}{对数函数的导数}
\beqskip{1pt}
	\onslide<+->
	设 $x$ 是正实数, 
	\onslide<+->
	则
	\[
		\ln (-x)=\ln x+\pi\ii,\quad
		\lim_{y\to0^-}\ln (-x+y\ii)=\ln x-\pi\ii,
	\]
	\onslide<+->
	因此 $\ln z$ 在负实轴和零处不连续.

	\onslide<+->
	而在其它地方 $-\pi<\arg z<\pi$, $\ln z$ 是 $\ee^z$ 在区域 $-\pi<\Im z<\pi$ 上的单值反函数, 
	\onslide<+->
	从而
	\alert{$(\ln z)'=\dfrac 1z$},
	\alert{$\ln z$ 在除负实轴和零处的区域解析}.

	\onslide<+->
	也可以通过C-R方程来得到 $\ln z$ 的解析性和导数: 当 $x>0$ 时,
	\[
		\ln z=\half \ln(x^2+y^2)+\ii\arctan \frac yx,
	\]
	\onslide<+->
	\[
		u_x=v_y=\frac x{x^2+y^2},\qquad v_x=-u_y=-\frac y{x^2+y^2},
	\]
	\[
		(\ln z)'=\frac{x-yi}{x^2+y^2}=\frac 1z.
	\]
	其它情形可取虚部为 $\arccot\dfrac xy$ 或 $\arccot\dfrac xy-\pi$ 类似证明.
\endgroup
\end{frame}


\subsection{幂函数}

\begin{frame}{幂函数的性质: $a$ 为整数时}
	\onslide<+->
	\begin{definition*}[][幂函数]
		\begin{enumerate}
			\item 设 $a\neq 0$, $z\neq 0$, 定义\emph{幂函数}
			\[
				w=z^a=\ee^{a\Ln z}
				=\exp\bigl[a\ln\abs{z}+\ii a(\arg z+2k\pi)\bigr],\quad k\in\BZ.
			\]
			\item \emph{幂函数的主值}为
			\[
				w=\ee^{a\ln z}=\exp\bigl(a\ln\abs{z}+\ii a\arg z\bigr).
			\]
		\end{enumerate}
		\bigdel
	\end{definition*}
	\onslide<+->
	根据 $a$ 的不同, 这个函数有着不同的性质.

	\onslide<+->
	当 $a$ 为整数时, 因为 $\ee^{2ak\pi\ii}=1$, 所以 $w=z^a$ 是单值的.
	\onslide<+->
	此时 $z^a$ 就是我们之前定义的乘幂.

	\onslide<+->
	当 $a$ 是非负整数时, $z^a$ 在复平面上解析;
	\onslide<+->
	当 $a$ 是负整数时, $z^a$ 在 $\BC-\{0\}$ 上解析.
\end{frame}


\begin{frame}{幂函数的性质: $a$ 为分数时}
	\onslide<+->
	当 $a=\dfrac pq$ 为分数, $p,q$ 为互质的整数且 $q>1$ 时,
	\onslide<+->
	\[
		z^{\frac pq}=\abs{z}^{\frac pq}\exp\left[\frac{\ii p(\arg z+2k\pi)}q\right],\quad k=0,1,\dots,q-1
	\]
	具有 $q$ 个值.
	\onslide<+->
	去掉负实轴和 $0$ 之后, 它的主值 $w=\exp(a\ln z)$ 是处处解析的.
	\onslide<+->
	事实上它就是 $\sqrt[q]{z^p}=(\sqrt[q]z)^p$.
	\onslide<+->
	\begin{center}
		\begin{tikzpicture}[scale=.8]
			\coordinate [label=below left:{$0$}] (O) at (0,0);
			\coordinate [label=below:{$x$}] (X) at (2,0);
			\coordinate [label=left:{$y$}] (Y) at (0,2);
			\draw[cstaxis] (O)--(X);
			\draw[cstaxis] (0,-2)--(Y);
			\draw[draw=white,cstfille1] (O) circle (1.3);
			\draw[cstdash,main] (0,0)--(-2,0);
			\draw[cstdash,cstra,third] (1.7,.7)to [bend left] (4.5,.7);
			\draw (3,1.7) node[third] {$w=z^{2/9}$};
			\begin{scope}[xshift=5cm]
				\coordinate [label=below left:{$0$}] (O) at (0,0);
				\fill[cstfille2,pattern color=second] (O)--({1.4*cos(40)},{1.4*sin(40)}) arc (40:-40:1.4)--cycle;
				\draw[cstdash,second] ({1.4*cos(40)},{-1.4*sin(40)})--(0,0)--({1.4*cos(40)},{1.4*sin(40)});
				\coordinate [label=below left:{$0$}] (O) at (0,0);
				\coordinate [label=below:{$u$}] (X) at (2,0);
				\coordinate [label=left:{$v$}] (Y) at (0,2);
				\draw[cstaxis] (-2,0)--(X);
				\draw[cstaxis] (0,-2)--(Y);
			\end{scope}
		\end{tikzpicture}
	\end{center}
\end{frame}


\begin{frame}{幂函数的性质: $a$ 为其他情形}
\onslide<+->
	对于其它的 $a$, $z^a$ 具有无穷多个值.
	\onslide<+->
	这是因为此时当 $k\neq0$ 时, $2k\pi a \ii$ 不可能是 $2\pi\ii$ 的整数倍. 
	\onslide<+->
	从而不同的 $k$ 得到的是不同的值.
	\onslide<+->
	去掉负实轴和 $0$ 之后,
	\onslide<+->
	它的主值 $w=\exp(a\ln z)$ 也是处处解析的.
	\onslide<+->
	\begin{center}
		\arrayrulecolor{second}
		\begin{tabular}{cccc} \toprule
			$a$& $z^a$ 的值& $z^a$ 的解析区域\\ \midrule
			&&$n\ge0$ 时处处解析\\
			\multirow{-2}*{整数 $n$}&\multirow{-2}*{单值}&$n<0$ 时除零点外解析\\ \midrule
			分数 $p/q$&$q$ 值&除负实轴和零点外解析\\ \midrule
			无理数或虚数&无穷多值&除负实轴和零点外解析\\ \bottomrule
		\end{tabular}
	\end{center}
\end{frame}


\begin{frame}{典型例题: 幂函数的计算}
	\onslide<+->
	\begin{example}
		求 $1^{\sqrt 2}$ 和 $\ii^\ii$.
	\end{example}
	\onslide<+->
	\begin{solution}
		\[
			1^{\sqrt2}=\ee^{\sqrt2\Ln1}
			\visible<+->{=\ee^{\sqrt 2\cdot 2k\pi\ii}}
			\visible<+->{=\cos(2\sqrt 2k\pi)+\ii\sin(2\sqrt 2k\pi), k\in\BZ.}
		\]
		\onslide<+->{%
			\[
				\ii^\ii=\ee^{\ii\Ln \ii}
				\visible<+->{=\exp\left[\ii\cdot\Bigl(2k+\half\Bigr)\pi\ii\right]}
				\visible<+->{=\exp\Bigl(-2k\pi-\half\pi\Bigr), k\in\BZ.}
			\]
		}\bigdel
	\end{solution}
	\onslide<+->
	\begin{exercise}
		$3^\ii$ 的辐角主值是\fillblankframe{$\ln 3$}.
	\end{exercise}
\end{frame}


\begin{frame}{幂函数的性质}
	幂函数与其主值有如下关系:
	\onslide<+->
	\[
		\emphn{z^a=\ee^{a\ln z}\cdot 1^a
		=\ee^{a\ln z}\cdot \ee^{2ak\pi\ii},\quad k\in\BZ.}
	\]

	\onslide<+->
	对于幂函数的主值,
	\[
		\alertn{(z^a)'}=\Bigl(\ee^{a\ln z}\Bigr)'=\frac{a\ee^{a\ln z}}z=\alertn{az^{a-1}}.
	\]

	\onslide<+->
	一般而言, $z^a\cdot z^b=z^{a+b}$ 和 $(z^a)^b=z^{ab}$ 都是不成立的.

	\onslide<+->
	最后, 注意 $\ee^a$ 作为指数函数 $f(z)=\ee^z$ 在 $a$ 处的值和作为 $g(z)=z^a$ 在 $e$ 处的值是\alert{不同}的.
	\onslide<+->
	因为后者在 $a\not\in\BZ$ 时总是多值的.
	\onslide<+->
	前者实际上是后者的主值.
	\onslide<+->
	为避免混淆, 以后我们总\alert{默认 $\ee^a$ 表示指数函数 $\exp a$}.
\end{frame}


\subsection{三角函数和反三角函数}

\begin{frame}{三角函数的定义}
	\onslide<+->
	我们知道
	\[
		\cos x=\frac{\ee^{\ii x}+\ee^{-\ii x}}2,\quad
		\sin x=\frac{\ee^{\ii x}-\ee^{-\ii x}}{2\ii}
	\]
	对于任意实数 $x$ 成立,
	\onslide<+->
	我们将其推广到复数情形.
	\onslide<+->
	\begin{definition*}[][余弦和正弦函数]
		\[
			\cos z=\frac{\ee^{\ii z}+\ee^{-\ii z}}2,\quad
			\sin z=\frac{\ee^{\ii z}-\ee^{-\ii z}}{2\ii}.
		\]
	\end{definition*}
	\onslide<+->
	那么欧拉恒等式 \emph{$\ee^{\ii z}=\cos z+\ii\sin z$ 对任意复数 $z$ 均成立}.
\end{frame}


\begin{frame}{三角函数的性质}
	\onslide<+->
	不难得到
	\[
		\cos(\ii y)=\dfrac{\ee^y+\ee^{-y}}2,\qquad
		\visible<+->{\sin(\ii y)=\ii\dfrac{\ee^y-\ee^{-y}}2.}
	\]
	\onslide<+->
	当 $y\to\infty$ 时, $\cos(\ii y)$ 和 $\sin(\ii y)$ 都 $\to\infty$.
	\onslide<+->
	因此 \alert{$\sin z$ 和 $\cos z$ 并不有界}. 
	\onslide<+->
	这和实变情形完全不同.

	\onslide<+->
	容易看出 $\cos z$ 和 $\sin z$ 的零点都是实数.
	\onslide<+->
	于是我们可类似定义其它三角函数
	\begin{align*}
		\alertn{\tan z}&
		\alertn{=\frac{\sin z}{\cos z},z\neq\Bigl(k+\half\Bigr)\pi,}&
		\alertn{\cot z}&
		\alertn{=\frac{\cos z}{\sin z},z\neq k\pi,}\\
		\alertn{\sec z}&
		\alertn{=\frac{1}{\cos z},z\neq\Bigl(k+\half\Bigr)\pi,}&
		\alertn{\csc z}&
		\alertn{=\frac{1}{\sin z},z\neq k\pi.}
	\end{align*}
\end{frame}


\begin{frame}{三角函数的性质}
	\onslide<+->
	这些三角函数的奇偶性, 周期性和导数与实变情形类似,
	\[
		\alertn{(\cos z)'=-\sin z,\quad
		(\sin z)'=\cos z,}
	\]
	\onslide<+->
	且在定义域范围内是处处解析的.

	\onslide<+->
	三角函数的各种恒等式在复数情形也仍然成立,
	\onslide<+->
	例如
	\begin{itemize}
		\item $\cos(z_1\pm z_2)=\cos z_1 \cos z_2\mp \sin z_1 \sin z_2$,
		\item $\sin(z_1\pm z_2)=\sin z_1 \cos z_2\pm\cos z_1 \sin z_2$,
		\item $\sin^2z+\cos^2z=1$.
	\end{itemize}
\end{frame}


\begin{frame}{双曲函数}
	\onslide<+->
	类似的, 我们可以定义双曲函数:
	\onslide<+->
	\[
		\alertn{\ch z=\frac{\ee^z+\ee^{-z}}2=\cos \ii z,}
	\]
	\onslide<+->
	\[
		\alertn{\sh z=\frac{\ee^z-\ee^{-z}}2=-\ii \sin \ii z,}
	\]
	\onslide<+->
	\[
		\alertn{\tanh z=\frac{\ee^z-\ee^{-z}}{\ee^z+\ee^{-z}}
		=-\ii \tan \ii z,\quad z\neq \Bigl(k+\half\Bigr)\pi\ii.}
	\]
	\onslide<+->
	它们的奇偶性和导数与实变情形类似, 在定义域范围内是处处解析的.

	\onslide<+->
	$\ch z,\sh z$ 的周期是 $2\pi\ii$, $\tanh z$ 的周期是 $\pi\ii$.
\end{frame}


\begin{frame}{反三角函数和反双曲函数}
	\onslide<+->
	设 $z=\cos w=\dfrac{\ee^{\ii w}+\ee^{-\ii w}}2$,
	\onslide<+->
	则
	\[
		\ee^{2\ii w}-2z\ee^{\ii w}+1=0,\quad
		\visible<+->{\ee^{\ii w}=z+\sqrt{z^2-1}\ \text{(双值)}.}
	\]
	\onslide<+->
	因此\emph{反余弦函数}为
	\[
		w=\Arccos z=-\ii \Ln(z+\sqrt{z^2-1}).
	\]
	\onslide<+->
	显然它是多值的.
	\onslide<+->
	同理, 我们有:
	\begin{itemize}
		\item \emph{反正弦函数} $\Arcsin z=-\ii \Ln(\ii z+\sqrt{1-z^2})$;
		\item \emph{反正切函数} $\Arctan z=-\dfrac \ii2\Ln\dfrac{1+\ii z}{1-\ii z}, z\neq \pm \ii$;
		\item \emph{反双曲余弦函数} $\Arch z=\Ln(z+\sqrt{z^2-1})$;
		\item \emph{反双曲正弦函数} $\Arsh z=\Ln(z+\sqrt{z^2+1})$;
		\item \emph{反双曲正切函数} $\Arth z=\dfrac12\Ln\dfrac{1+z}{1-z}, z\neq \pm1$.
	\end{itemize}
\end{frame}


\begin{frame}{例题: 解三角函数方程}
	\onslide<+->
	\begin{example}
		解方程 $\sin z=2$.
	\end{example}
	\onslide<+->
	\begin{solution}
	由于 $\sin z=\dfrac{\ee^{\ii z}-\ee^{-\ii z}}{2\ii}=2$,
	\onslide<+->{%
		我们有
		\[
			\ee^{2\ii z}-4\ii\ee^{\ii z}-1=0.
		\]
	}\onslide<+->{%
		于是 $\ee^{\ii z}=(2\pm\sqrt 3)\ii$,
	}\onslide<+->{%
		\[
			z=-\ii \Ln[(2\pm\sqrt 3)\ii]=\Bigl(2k+\half\Bigr)\pi\pm \ii\ln(2+\sqrt3),\quad k\in\BZ.
		\]
	}\bigdel
	\end{solution}
\end{frame}

\begin{frame}{例题: 解三角函数方程}
	\onslide<+->
	\begin{solution}[][另解]
	由 $\sin z=2$ 可知
	\[
		\cos z=\sqrt{1-\sin^2 z}=\pm\sqrt 3\ii.
	\]
	\onslide<+->{%
		于是 $\ee^{\ii z}=\cos z+\ii\sin z=(2\pm\sqrt 3)\ii$,
	}\onslide<+->{%
		\[
			z=-\ii \Ln[(2\pm\sqrt 3)\ii]=\Bigl(2k+\half\Bigr)\pi\pm \ii\ln(2+\sqrt3),\quad k\in\BZ.
		\]
	}\bigdel
	\end{solution}
	\onslide<+->
	对于任意 $z$, 总存在 $\theta$ 使得
	\begin{align*}
		\Arcsin z&=(2k+\half)\pi\pm \theta,\\
		\Arccos z&=2k\pi\pm \theta,\\
		\Arctan z&=k\pi+\theta,\quad (z\ne\pm\ii).
	\end{align*}
\end{frame}


\subsection{在有理函数的应用}


\begin{frame}{有理函数分拆}
	\onslide<+->
	称分子次数小于分母次数的有理函数为\emph{真分式}.
	\onslide<+->
	任何一个有理函数 $f(z)$ 都可以通过带余除法分解为一个多项式 $g(z)$ 和一个真分式之和.

	\onslide<+->
	若这个有理函数分母的零点均能求出, 则这个真分式又可以分拆为部分分式之和, 其中\emph{部分分式}是指形如 $\dfrac{a}{(x-b)^k}$ 的真分式.
	\onslide<+->
	我们来介绍求这种分拆的一种方法.
\end{frame}


\begin{frame}{例题: 有理函数分拆}
	\beqskip{2pt}
	\onslide<+->
	\begin{example}[near]
		将 $f(z)=\dfrac{1}{(z-1)(z-2)^2}$ 展开成部分分式之和.
	\end{example}
	\onslide<+->
	\begin{solution}[near]
		设 $f(z)=\dfrac{a}{z-1}+\dfrac{b}{z-2}+\dfrac{c}{(z-2)^2}$,
		\onslide<+->{%
			则
			\begin{align*}
				a&=\lim_{z\ra1} (z-1)f(z)
					=\lim_{z\ra1} \frac{1}{(z-2)^2}
					=1,\\
				\onslide<+->{b}&\onslide<.->{=\lim_{z\ra2} \bigl((z-2)^2f(z)\bigr)'
					=\lim_{z\ra2} \Bigl(\frac{1}{z-1}\Bigr)'
					=-1,}\\
				\onslide<+->{c}&\onslide<.->{=\lim_{z\ra2} (z-2)^2f(z)
					=\lim_{z\ra2} \frac{1}{z-1}=1.}
			\end{align*}
		}\onslide<+->{%
			因此
			\[
				f(z)=\frac{1}{z-1}-\frac{1}{z-2}+\frac{1}{(z-2)^2}.
			\]
		}\bigdel
	\end{solution}
	\endgroup
\end{frame}


\begin{frame}{有理函数的导数\noexer}
	\onslide<+->
	得到这种分拆之后, 我们可以求出该有理函数的任意阶导数.
	\onslide<+->
	\begin{example}[nearnext]
		计算 $f(x)=\dfrac1{1+x^2}$ 的 $n$ 阶导数.
	\end{example}
	\onslide<+->
	\begin{solution}[nearprev]
		设
		\[
			f(z)
			=\frac1{1+z^2}
			=\frac \ii2\biggl(\frac1{z+\ii}-\frac1{z-\ii}\biggr),
		\]
		\onslide<+->{%
			则它在除 $z=\pm \ii$ 外处处解析,
		}\onslide<+->{%
			且
			\begin{align*}
				f^{(n)}(z)&
				=\frac \ii2\biggl(\frac1{z+\ii}-\frac1{z-\ii}\biggr)^{(n)}
				\onslide<+->{=\frac \ii2\cdot(-1)^n n!\biggl(\frac1{(z+\ii)^{n+1}}-\frac1{(z-\ii)^{n+1}}\biggr)}\\&
				\onslide<+->{=(-1)^{n+1}n!\Im{(z+\ii)^{-n-1}}.}
			\end{align*}
		}\bigdel
	\end{solution}
\end{frame}
	
	
\begin{frame}{有理函数的导数}
	\onslide<+->
	\begin{solution}[][]%
		当 $z=x$ 为实数时,
		\[
			\abs{x+\ii}=\sqrt{x^2+1},\qquad
			\arg(x+\ii)=\arccot x,
		\]
		\onslide<+->{%
			于是
			\[
				\frac1{(z\pm\ii)^{n+1}}=(x^2+1)^{-\frac{n+1}2}\ee^{\pm\ii (n+1)\arccot x}.
			\]
		}\onslide<+->{%
			因此
			\[
				\biggl(\frac1{1+x^2}\biggr)^{(n)}
				=(-1)^nn!(x^2+1)^{-\frac{n+1}2}\sin\bigl((n+1)\arccot x\bigr).
			\]
		}
	\end{solution}
\end{frame}


\begin{frame}{有理函数的不定积分\noexer}
	\onslide<+->
	我们还可以利用复对数函数来计算实有理函数的不定积分.
	\onslide<+->
	\begin{example}[nearnext]
		计算 $\dint \frac1{x^3-1}\d x$.
	\end{example}
	\onslide<+->
	\begin{solution}[nearprev]
		设 $\zeta=\ee^{\frac{2\cpi\ii}3}=\dfrac{-1+\sqrt3\ii}2$, 
		\onslide<+->{%
			那么我们有分拆
			\[
				f(x)
				=\frac1{x^3-1}
				=\frac13\Bigl(\frac{1}{x-1}+\frac{\zeta}{x-\zeta}+\frac{\zeta^2}{x-\zeta^2}\Bigr),
			\]
		}\onslide<+->{%
			设
			\[
				g(z)=\frac13\bigl(
					\ln(z-1)+\zeta\ln(z-\zeta)+\zeta^2\ln(z-\zeta^2)
				\bigr).
			\]
		}\bigdel
	\end{solution}
\end{frame}
	
	
\begin{frame}{有理函数的不定积分\noexer}
	\beqskip{5pt}
	\onslide<+->
	\begin{solution}[][]%
		$g(z)$ 在复平面去掉三条射线 $x+\zeta^k,x\le 0$ 内的导数为 $f(z)$.
		\onslide<+->{%
			当 $z=x>1$ 时, 
			\begin{align*}
				&3g(z)-\ln(x-1)=2\Re\bigl(\zeta\ln(x-\zeta)\bigr)
				=2\Re\biggl(\frac{-1+\sqrt3\ii}2\ln\Bigl(x-\frac{-1+\sqrt3\ii}2\Bigr)\biggr)\\
				={}&2\Re\biggl(
					\frac{-1+\sqrt3\ii}2
						\Bigl(\ln\sqrt{x^2+x+1}-\ii\arccot\frac{2x+1}{\sqrt3}\Bigr)
					\biggr)\\
				={}&\ln\sqrt{x^2+x+1}+\sqrt 3\arccot\frac{2x+1}{\sqrt3}.
			\end{align*}
		}\onslide<+->{%
			于是我们得到当 $x>1$ 时,
			\[
				g(x)=\frac13\ln\abs{x-1}-\frac16\ln(x^2+x+1)
					+\frac{\sqrt3}3\arccot\frac{2x+1}{\sqrt3}.
			\]
		}\onslide<+->{%
			可以看出对于实数 $x<1$, 上式的导数也等于 $f(x)$, 从而 $f(x)$ 的不定积分为 $g(x)+C$, $C\in\BR$.
		}
	\end{solution}
	\endgroup
\end{frame}