\section{留数的应用}

\subsection{三角函数的有理函数的积分}

\begin{frame}{三角函数的有理函数的积分}
	\onslide<+->
	本节中我们将对若干种在实变中难以计算的定积分和广义积分使用复变函数和留数的技巧进行计算.
	\onslide<+->
	相应计算公式会在考试中按需提供.

	\onslide<+->
	考虑 $\dint_0^{2\pi} R(\cos\theta,\sin\theta)\d\theta$, 其中 $R$ 是一个有理函数.
	\onslide<+->
	令 $z=\ee^{\ii\theta}$, 则 $\d z=\ii z\d\theta$,
	\onslide<+->
	\[
		\cos\theta=\half\Bigl(z+\frac1z\Bigr)=\frac{z^2+1}{2z},\quad
		\sin\theta=\frac1{2\ii}\Bigl(z-\frac1z\Bigr)=\frac{z^2-1}{2\ii z},
	\]
	\onslide<+->
	\[
		\alertn{\int_0^{2\pi} R(\cos\theta,\sin\theta)\d\theta=\oint_{\abs{z}=1}R\Bigl(\frac{z^2+1}{2z},\frac{z^2-1}{2\ii z}\Bigr)\frac1{\ii z}\d z.}
	\]
	\onslide<+->
	由于被积函数是一个有理函数, 它的积分可以由 $\abs{z}<1$ 内奇点留数得到.
\end{frame}


\begin{frame}{例题: 三角函数的有理函数的积分}\small
	\beqskip{1pt}
	\onslide<+->
	\begin{example}[nearnext]
		求 $\dint_0^{2\pi}\frac{\sin^2\theta}{5-3\cos\theta}\d\theta$.
	\end{example}
	\onslide<+->
	\begin{solution}[nearprev]
		令 $z=\ee^{\ii\theta}$, 则 $\d z=\ii z\d\theta$,
		\onslide<+->{%
			\[
				\cos\theta=\half\Bigl(z+\frac1z\Bigr)=\frac{z^2+1}{2z},\qquad
				\sin\theta=\frac1{2\ii}\Bigl(z-\frac1z\Bigr)=\frac{z^2-1}{2\ii z},
			\]
		}\onslide<+->{%
			\[
				\int_0^{2\pi}\frac{\sin^2\theta}{5-3\cos\theta}\d\theta
				=\oint_{\abs{z}=1}\frac{(z^2-1)^2}{-4z^2}\cdot\frac1{5-3\dfrac{z^2+1}{2z}}\cdot\frac{\d z}{\ii z}
				=-\frac \ii6\oint_{\abs{z}=1}\frac{(z^2-1)^2}{z^2(z-3)(z-\dfrac13)}\d z.
			\]
		}\onslide<+->{%
			设 $f(z)=\dfrac{(z^2-1)^2}{z^2(z-3)(z-\frac13)}$,
		}\onslide<+->{%
			则
			$\Res[f(z),0]=\dfrac{10}3, \Res[f(z),\dfrac13]=-\dfrac83$,
		}
		\onslide<+->{
			\[
				\int_0^{2\pi}\frac{\sin^2\theta}{5-3\cos\theta}\d\theta
				=-\frac \ii6\cdot 2\pi\ii\Bigl[\Res[f(z),0]+\Res[f(z),\frac13]\Bigr]
				=\frac{2\pi}9.
			\]
		}\meddel
	\end{solution}
	\endgroup
\end{frame}

\subsection{有理函数的广义积分}

\begin{frame}{有理函数的广义积分}
	\onslide<+->
	考虑 $\intff f(x)\d x$, 其中 $f(x)$ 是一个有理函数, 分母比分子至少高 $2$ 次, 且分母没有实根.
	\onslide<+->
	我们先考虑 $\dint_{-r}^rf(x)\d x$.
	\onslide<+->
	设 $C=C_r+[-r,r]$ 如下图所示, 使得上半平面内 $f(z)$ 的奇点均在 $C$ 内,
	\onslide<+->
	则
	\[
		2\pi\ii\sum_{\Im a>0}\Res[f(z),a]=\oint_Cf(z)\d z=\int_{-r}^rf(x)\d x+\int_{C_r}f(z)\d z.
	\]
	\onslide<3->
	\begin{center}
		\begin{tikzpicture}
			\draw[cstaxis] (-2,0)--(2,0);
			\draw[cstaxis] (0,-0.2)--(0,2);
			\draw[cstcurve,main] (-1.5,0) arc(180:0:1.5);
			\draw[cstcurve,main,cstla] (-1.2,0.9) arc(135:130:1.5);
			\draw[cstcurve,second] (-1.5,0)--(1.5,0);
			\draw[cstcurve,second,cstra] (-1.5,0)--(-0.5,0);
			\draw
				(-1.5,-0.3) node[second] {$-r$}
				(1.5,-0.3) node[second] {$r$}
				(1.3,1.2) node[main] {$C_r$};
		\end{tikzpicture}
	\end{center}
\end{frame}


\begin{frame}{有理函数的广义积分}
	\onslide<+->
	由于 $P(x)$ 分母次数比分子至少高 $2$ 次,
	\onslide<+->
	当 $r\to+\infty$ 时,
	\[
		\biggabs{\int_{C_r}f(z)\d z}\le \pi r\max_{\abs{z}=r}\abs{f(z)}
		=\pi \max_{\abs{z}=r}\abs{zf(z)}\to 0.
	\]
	\onslide<+->
	故
	\[
		\alertn{\intff f(x)\d x=2\pi\ii\sum_{\Im a>0}\Res[R(z),a].}
	\]
	\onslide<+->
	这里, 由于积分收敛, 因此广义积分值和其柯西主值
	\[
		\PV\intff f(x)\d x=\lim_{r\to+\infty}\int_{-r}^rf(x)\d x
	\]
	相等.
\end{frame}


\begin{frame}{例题: 有理函数的广义积分}
	\onslide<+->
	\begin{example}[nearnext]
		求 $\intff \frac{\d x}{(x^2+a^2)^3},a>0$.
	\end{example}
	\onslide<+->
	\begin{solution}[nearprev]
		$f(z)=\dfrac1{(z^2+a^2)^3}$ 在上半平面内的奇点为 $a\ii$.
		\onslide<+->{
			\begin{align*}
				\Res[f(z),a\ii]&=\frac1{2!}\lim_{z\to a\ii}\left[\frac1{(z+a\ii)^3}\right]''\\
				&=\half\lim_{z\to a\ii}\frac{12}{(z+a\ii)^5}=\frac{3}{16a^5\ii},
			\end{align*}
		}\onslide<+->{%
			故
			\[
				\intff \frac{\d x}{(x^2+a^2)^3}
				=2\pi\ii\Res[f(z),a\ii]=\frac{3\pi}{8a^5}.
			\]
		}\bigdel
	\end{solution}
\end{frame}


\subsection{有理函数与正弦、余弦之积的广义积分}

\begin{frame}{有理函数与正弦、余弦之积的广义积分}
	\onslide<+->
	考虑 $\intff f(x)\cos{\lambda x}\d x$,
	$\intff f(x)\sin{\lambda x}\d x$, 其中 $f(x)$ 是一个有理函数, 分母比分子至少高 $2$ 次, 且分母没有实根.
	\onslide<+->
	和前一种情形类似, 我们有
	\[
		\alertn{\intff f(x)\ee^{\ii\lambda x}\d x
		=2\pi\ii\sum_{\Im a>0}\Res[f(z)\ee^{\ii\lambda z},a],}
	\]
	\onslide<+->
	因此所求积分分别为它的实部和虚部.
\end{frame}


\begin{frame}{例题: 有理函数与正弦、余弦之积的广义积分}
	\beqskip{2pt}
	\onslide<+->
	\begin{example}[nearnext]
		求 $\intff \frac{\cos x\d x}{(x^2+a^2)^2}, a>0$.
	\end{example}
	\onslide<+->
	\begin{solution}[nearprev]
		$f(z)=\dfrac{\ee^{\ii z}}{(z^2+a^2)^2}$ 在上半平面内的奇点为 $a\ii$,
		\onslide<+->{%
			\[
				\Res[f(z),a\ii]=\lim_{z\to a\ii}\left[\frac{\ee^{\ii z}}{(z+a\ii)^2}\right]'=-\frac{\ee^{-a}(a+1)\ii}{4a^3}.
			\]
		}\onslide<+->{%
			故
			\[
				\intff \frac{\ee^{\ii x}\d x}{(x^2+a^2)^2}=2\pi\ii \Res[f(z),a\ii]=\frac{\pi \ee^{-a}(a+1)}{2a^3},
			\]
		}\onslide<+->{%
			\[
				\intff \frac{\cos x\d x}{(x^2+a^2)^2}=\frac{\pi \ee^{-a}(a+1)}{2a^3}.
			\]
		}\meddel
	\end{solution}
	\endgroup
\end{frame}

\subsection{含幂函数的积分}

\begin{frame}{含幂函数的积分}
	\onslide<+->
	\begin{theorem}
		设实数 $p$ 不是整数, $f(x)$ 是一个有理函数, 分母没有正实根, 且满足
		\[
			\lim_{x\ra 0} x^{p+1}f(x)=0,\quad
			\lim_{x\ra \infty} x^{p+1}f(x)=0,
		\]
		\onslide<+->{%
			则
			\[
				\intf f(x)x^p\d x
				=-\frac{\pi}{\sin{p\pi}}\sum_a \Res\bigl[\ee^{p\ln(-z)}f(z),a\bigr],
			\]
			其中 $a$ 取遍 $f(z)$ 的非零奇点.
		}
	\end{theorem}
\end{frame}


\begin{frame}{例题: 含幂函数的积分}
	\onslide<+->
	\begin{example}[near]
		计算 $\intf\frac{x^p}{x(x+1)}\d x,0<p<1$.
	\end{example}
	\onslide<+->
	\begin{solution}[near]
		设
		\[
			f(z)=\frac{\ee^{p\ln(-z)}}{z(z+1)},
		\]
		\onslide<+->{%
			则 $f(z)$ 在正实轴和零以外的奇点为 $a=-1$, 且
			\[
				\Res[f(z),-1]
				=\lim_{z\ra-1}\frac{\ee^{p\ln(-z)}}{z}
				=-\ee^{p\ln 1}
				=-1.
			\]
		}\onslide<+->{%
			因此
			\[
				\intf\frac{x^p}{x(x+1)}\d x
				=\frac{\pi}{\sin p\pi}.
			\]
		}\bigdel
	\end{solution}
\end{frame}

\subsection{含对数函数的积分}

\begin{frame}{含对数函数的积分}
	\onslide<+->
	\begin{theorem}
		设 $f(x)$ 是一个有理函数, 分母没有正实根, 且分母至少比分子高 $2$ 次, 则
		\[
			\intf f(x)\ln x\d x
			=-\frac12 \sum_a \Res\bigl[\ln^2(-z)f(z),a\bigr],
		\]
		其中 $a$ 取遍 $f(z)$ 的奇点.
	\end{theorem}
\end{frame}


\begin{frame}{例题: 含对数函数的积分}
	\onslide<+->
	\begin{example}[nearnext]
		计算 $I=\intf\dfrac{\ln x}{x^2-2x+2}\d x$.
	\end{example}
	\onslide<+->
	\begin{solution}[nearprev]
		设
		\[
			f(z)=\frac{\ln^2(-z)}{z^2-2z+2},
		\]
		\onslide<+->{%
			则 $f(z)$ 在正实轴和零以外的奇点为 $1\pm\ii$, 且
			\begin{align*}
				\Res[f(z),1+\ii]&
				=\lim_{z\ra 1+\ii}\frac{\ln^2(-z)}{z-(1-\ii)}
				=\frac1{2\ii}\Bigl(\frac12\ln2-\frac{3\pi\ii}4\Bigr)^2,
				\\
				\Res[f(z),1-\ii]&
				=\lim_{z\ra 1-\ii}\frac{\ln^2(-z)}{z-(1+\ii)}
				=-\frac1{2\ii}\Bigl(\frac12\ln2+\frac{3\pi\ii}4\Bigr)^2.
			\end{align*}
		}\bigdel
	\end{solution}
\end{frame}
	
	
\begin{frame}{例题: 含对数函数的积分}
	\onslide<+->
	\begin{solution}[][]
		由于二者互为共轭, 二者之和为 
		\[
			2\Re\biggl(\frac1{2\ii}\Bigl(\frac12\ln2-\frac{3\pi\ii}4\Bigr)^2\biggr)
			=-\frac{3\pi}4\ln2.
		\]
		因此 
		\[
			I=\frac{3\pi}8\ln2.
		\]
	\end{solution}
\end{frame}


% \subsection{其它例子}

% \begin{frame}{例题: 留数在定积分上的应用}
% 	\onslide<+->
% 	最后我们再来看一个例子.
% 	\onslide<+->
% 	\begin{example}[nearnext]
% 		求积分 $I=\dint_0^{+\infty}\frac{x^p}{x(x+1)}\d x,0<p<1$.
% 	\end{example}
% 	\onslide<+->
% 	\begin{solution}[nearprev]
% 	\[
% 		I=\int_0^{+\infty}\frac{x^p}{x(x+1)}\d x\xto{\text{令}\ x=\ee^t}\intff \frac{\ee^{pt}}{\ee^t+1}\d t.
% 	\]
% 		\onslide<+->{考虑 $f(z)=\dfrac{\ee^{pz}}{\ee^z+1}$ 在如下闭路 $C$ 上的积分.
% 		\begin{center}
% 			\begin{tikzpicture}[scale=.8]
% 				\draw[cstaxis] (-3,0)--(3,0);
% 				\draw[cstaxis] (0,0)--(0,1.7);
% 				\draw[cstcurve,second] (-1.5,0) rectangle (1.5,1.2);
% 				\draw[cstcurve,main] (-1.5,0)--(-1.5,1.2);
% 				\draw[cstcurve,main] (1.5,0)--(1.5,1.2);
% 				\draw[cstcurve,second,cstra] (-1.5,0)--(-0.5,0);
% 				\draw[cstcurve,second,cstra] (0,1.2)--(-0.5,1.2);
% 				\draw[cstcurve,main,cstra] (1.5,0)--(1.5,0.9);
% 				\draw[cstcurve,main,cstra] (-1.5,1.2)--(-1.5,0.3);
% 				\draw
% 					(1.8,0.3) node {$R$}
% 					(-2,0.3) node {$-R$}
% 					(0.4,0.8) node {$2\pi\ii$}
% 					(1.2,0.4) node[main] {$C_1$}
% 					(-1.1,0.5) node[main] {$C_2$}
% 					(-0.4,0.8) node[second] {$l$};
% 			\end{tikzpicture}
% 		\end{center}}
% 	\end{solution}
% \end{frame}


% \begin{frame}{例题: 留数在定积分上的应用}
% 	\onslide<+->
% 	\begin{solution}[][]
% 		由于 $l:z=t+2\pi\ii,-R\le t\le R$,
% 		\onslide<+->{%
% 			因此
% 			\[
% 				\int_l f(z)\d z
% 				=\int_R^{-R}\frac{\ee^{2p\pi\ii}\cdot \ee^{pt}}{\ee^t+1}\d t
% 				=-\ee^{2p\pi\ii}\int_{-R}^Rf(t)\d t.
% 			\]
% 		}\onslide<+->{%
% 			由于 $C_1:z=R+\ii t,0\le t\le 2\pi$,
% 		}\onslide<+->{%
% 			因此
% 			\[
% 				\abs{\int_{C_1}f(z)\d z}\le \frac{\ee^{pR}}{\ee^R-1}\cdot 2\pi\to 0\quad(R\to+\infty).
% 			\]
% 		}\onslide<+->{%
% 			同理
% 			\[
% 				\abs{\int_{C_2}f(z)\d z}\le \frac{\ee^{-pR}}{1-\ee^{-R}}\cdot 2\pi\to 0\quad(R\to+\infty).
% 			\]
% 		}\bigdel
% 	\end{solution}
% \end{frame}


% \begin{frame}{例题: 留数在定积分上的应用}
% 	\onslide<+->
% 	\begin{solution}[][]
% 		由于
% 		\[
% 			\Res[f(z),\pi\ii]
% 			=\frac{\ee^{pz}}{(\ee^z+1)'}\bigg|_{z=\pi\ii}=-\ee^{p\pi\ii},
% 		\]
% 		\onslide<+->{%
% 			因此
% 			\begin{align*}
% 				&\Bigl(\int_{-R}^R+\int_l+\int_{C_1}+\int_{C_2}\Bigr)f(z)\d z\\
% 				=&\oint_Cf(z)\d z=2\pi\ii\Res[f(z),\pi\ii]=-2\pi\ii\ee^{p\pi\ii},
% 			\end{align*}
% 		}\onslide<+->{%
% 			令 $R\to+\infty$,
% 		}\onslide<+->{%
% 			则
% 			\begin{align*}
% 				&(1-\ee^{2p\pi\ii})I=-2\pi\ii\ee^{p\pi\ii},\quad
% 				\visible<+->{I=\frac{2\pi\ii}{\ee^{p\pi\ii}-\ee^{-p\pi\ii}}=\frac{\pi}{\sin p\pi}.}
% 			\end{align*}
% 		}\bigdel
% 	\end{solution}
% \end{frame}

